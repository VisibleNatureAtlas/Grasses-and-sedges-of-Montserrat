
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Load occurence data &#8212; Grasses and sedges of Montserrat (English)</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=9c3e77be" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=1ae7504c"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'inspectData';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro_en.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Grasses and sedges of Montserrat (English) - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Grasses and sedges of Montserrat (English) - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro_en.html">
                    Visible Nature Atlas: Grasses and sedges of Montserrat
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Collections with grasses and sedges from Montserrat</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="organisation/Meise_Botanic_Garden.html">Meise Botanic Garden</a></li>


<li class="toctree-l1"><a class="reference internal" href="organisation/Quentin_Groom.html">Quentin Groom</a></li>

<li class="toctree-l1"><a class="reference internal" href="organisation/Sofie_Meeus.html">Sofie Meeus</a></li>

<li class="toctree-l1"><a class="reference internal" href="organisation/The_New_York_Botanical_Garden.html">The New York Botanical Garden</a></li>















<li class="toctree-l1"><a class="reference internal" href="organisation/University_of_Florida.html">University of Florida</a></li>

<li class="toctree-l1"><a class="reference internal" href="organisation/classical.html">classical</a></li>

<li class="toctree-l1"><a class="reference internal" href="organisation/nan.html">nan</a></li>




















</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Taxa originally from Montserrat</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="taxa_en/Andropogon_bicornis.html"><em>Andropogon bicornis</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="taxa_en/Anthephora_hermaphrodita.html"><em>Anthephora hermaphrodita</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="taxa_en/Aristida_adscensionis.html"><em>Aristida adscensionis</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="taxa_en/Axonopus_compressus.html"><em>Axonopus compressus</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="taxa_en/Brachiaria_fasciculata.html"><em>Brachiaria fasciculata</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="taxa_en/Cenchrus_echinatus.html"><em>Cenchrus echinatus</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="taxa_en/Coix_lacryma-jobi.html"><em>Coix lacryma-jobi</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="taxa_en/Cymbopogon_citratus.html"><em>Cymbopogon citratus</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="taxa_en/Cyperus_alopecuroides.html"><em>Cyperus alopecuroides</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="taxa_en/Cyperus_brevifolius.html"><em>Cyperus brevifolius</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="taxa_en/Cyperus_sphacelatus.html"><em>Cyperus sphacelatus</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="taxa_en/Digitaria_bicornis.html"><em>Digitaria bicornis</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="taxa_en/Digitaria_insularis.html"><em>Digitaria insularis</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="taxa_en/Eleocharis_flavescens.html"><em>Eleocharis flavescens</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="taxa_en/Eriochloa_punctata.html"><em>Eriochloa punctata</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="taxa_en/Fimbristylis_complanata.html"><em>Fimbristylis complanata</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="taxa_en/Lasiacis_divaricata.html"><em>Lasiacis divaricata</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="taxa_en/Lasiacis_sorghoidea.html"><em>Lasiacis sorghoidea</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="taxa_en/Machaerina_restioides.html"><em>Machaerina restioides</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="taxa_en/Panicum_trichoides.html"><em>Panicum trichoides</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="taxa_en/Paspalum_conjugatum.html"><em>Paspalum conjugatum</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="taxa_en/Paspalum_fimbriatum.html"><em>Paspalum fimbriatum</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="taxa_en/Rhynchospora_nervosa.html"><em>Rhynchospora nervosa</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="taxa_en/Rhynchospora_tenerrima.html"><em>Rhynchospora tenerrima</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="taxa_en/Scleria_secans.html"><em>Scleria secans</em></a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/VisibleNatureAtlas/Grasses-and-sedges-of-Montserrat" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/VisibleNatureAtlas/Grasses-and-sedges-of-Montserrat/issues/new?title=Issue%20on%20page%20%2FinspectData.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/inspectData.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Load occurence data</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Load occurence data</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#fetch-institute-qid-s-for-institutes">Fetch institute QID’s for institutes</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#resolve-taxonnames-and-kingdom">resolve taxonnames and kingdom</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#merge-taxonnames-and-kingdom">Merge taxonnames and kingdom</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#below-is-for-reference-only">Below is for reference only</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">mdutils.mdutils</span><span class="w"> </span><span class="kn">import</span> <span class="n">MdUtils</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tqdm</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">wikidataintegrator</span><span class="w"> </span><span class="kn">import</span> <span class="n">wdi_core</span><span class="p">,</span> <span class="n">wdi_login</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">rdflib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Graph</span><span class="p">,</span> <span class="n">Literal</span><span class="p">,</span> <span class="n">RDF</span><span class="p">,</span> <span class="n">URIRef</span><span class="p">,</span> <span class="n">Namespace</span><span class="p">,</span> <span class="n">BNode</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">rdflib.namespace</span><span class="w"> </span><span class="kn">import</span> <span class="n">DCTERMS</span><span class="p">,</span> <span class="n">FOAF</span><span class="p">,</span> <span class="n">XSD</span><span class="p">,</span> <span class="n">DC</span><span class="p">,</span> <span class="n">RDFS</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
</pre></div>
</div>
</div>
</div>
<section class="tex2jax_ignore mathjax_ignore" id="load-occurence-data">
<h1>Load occurence data<a class="headerlink" href="#load-occurence-data" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/0002020-240626123714530/occurrence.txt&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">on_bad_lines</span> <span class="o">=</span> <span class="s1">&#39;warn&#39;</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gbifID</th>
      <th>accessRights</th>
      <th>bibliographicCitation</th>
      <th>language</th>
      <th>license</th>
      <th>modified</th>
      <th>publisher</th>
      <th>references</th>
      <th>rightsHolder</th>
      <th>type</th>
      <th>...</th>
      <th>publishedByGbifRegion</th>
      <th>level0Gid</th>
      <th>level0Name</th>
      <th>level1Gid</th>
      <th>level1Name</th>
      <th>level2Gid</th>
      <th>level2Name</th>
      <th>level3Gid</th>
      <th>level3Name</th>
      <th>iucnRedListCategory</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4876300936</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CC_BY_4_0</td>
      <td>2023-03-20T00:00:00Z</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Meise Botanic Garden</td>
      <td>PhysicalObject</td>
      <td>...</td>
      <td>EUROPE</td>
      <td>MSR</td>
      <td>Montserrat</td>
      <td>MSR.3_1</td>
      <td>Saint Peter</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LC</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4876284841</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CC_BY_4_0</td>
      <td>2023-03-21T00:00:00Z</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Meise Botanic Garden</td>
      <td>PhysicalObject</td>
      <td>...</td>
      <td>EUROPE</td>
      <td>MSR</td>
      <td>Montserrat</td>
      <td>MSR.3_1</td>
      <td>Saint Peter</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NE</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4607368012</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CC_BY_NC_4_0</td>
      <td>2024-05-24T09:26:47Z</td>
      <td>NaN</td>
      <td>https://www.inaturalist.org/observations/20511...</td>
      <td>slauren</td>
      <td>NaN</td>
      <td>...</td>
      <td>NORTH_AMERICA</td>
      <td>MSR</td>
      <td>Montserrat</td>
      <td>MSR.3_1</td>
      <td>Saint Peter</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NE</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4536015362</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CC0_1_0</td>
      <td>2024-04-26T16:57:26Z</td>
      <td>NaN</td>
      <td>https://www.inaturalist.org/observations/20102...</td>
      <td>monkeyjodey</td>
      <td>NaN</td>
      <td>...</td>
      <td>EUROPE</td>
      <td>MSR</td>
      <td>Montserrat</td>
      <td>MSR.3_1</td>
      <td>Saint Peter</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NE</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4536000017</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CC0_1_0</td>
      <td>2024-04-26T16:57:26Z</td>
      <td>NaN</td>
      <td>https://www.inaturalist.org/observations/20125...</td>
      <td>monkeyjodey</td>
      <td>NaN</td>
      <td>...</td>
      <td>EUROPE</td>
      <td>MSR</td>
      <td>Montserrat</td>
      <td>MSR.1_1</td>
      <td>Saint Anthon</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NE</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>82</th>
      <td>1319347135</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CC0_1_0</td>
      <td>2017-10-31T12:14:00Z</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NORTH_AMERICA</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LC</td>
    </tr>
    <tr>
      <th>83</th>
      <td>1318020074</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CC0_1_0</td>
      <td>2017-10-31T12:10:00Z</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NORTH_AMERICA</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NE</td>
    </tr>
    <tr>
      <th>84</th>
      <td>1317614158</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CC0_1_0</td>
      <td>2021-03-06T11:43:00Z</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NORTH_AMERICA</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NE</td>
    </tr>
    <tr>
      <th>85</th>
      <td>1317605282</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CC0_1_0</td>
      <td>2021-03-08T09:38:00Z</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NORTH_AMERICA</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NE</td>
    </tr>
    <tr>
      <th>86</th>
      <td>1056947532</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CC0_1_0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>EUROPE</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NE</td>
    </tr>
  </tbody>
</table>
<p>87 rows × 223 columns</p>
</div></div></div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="fetch-institute-qid-s-for-institutes">
<h1>Fetch institute QID’s for institutes<a class="headerlink" href="#fetch-institute-qid-s-for-institutes" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">user_agent</span> <span class="o">=</span> <span class="s1">&#39;TaxonQueries/1.0 (andra@micelio.be) SPARQL queries&#39;</span>  <span class="c1"># Replace with your actual User-Agent string</span>

<span class="n">result_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Institute&#39;</span><span class="p">,</span> <span class="s1">&#39;Institute_QID&#39;</span><span class="p">])</span>
<span class="n">batchSize</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">retry_wait_time</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Initial wait time in seconds</span>
<span class="n">institutes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;rightsHolder&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">institutes</span><span class="p">)</span>
<span class="n">instituteQID</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">notFound</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">institute</span> <span class="ow">in</span> <span class="n">institutes</span><span class="p">:</span>
    <span class="n">en</span> <span class="o">=</span> <span class="n">wdi_core</span><span class="o">.</span><span class="n">WDItemEngine</span><span class="o">.</span><span class="n">get_wd_search_results</span><span class="p">(</span><span class="n">institute</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="s1">&#39;en&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">en</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">instituteQID</span><span class="p">[</span><span class="n">institute</span><span class="p">]</span> <span class="o">=</span> <span class="n">en</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">continue</span>
    <span class="n">nl</span> <span class="o">=</span> <span class="n">wdi_core</span><span class="o">.</span><span class="n">WDItemEngine</span><span class="o">.</span><span class="n">get_wd_search_results</span><span class="p">(</span><span class="n">institute</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="s1">&#39;nl&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nl</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">instituteQID</span><span class="p">[</span><span class="n">institute</span><span class="p">]</span> <span class="o">=</span> <span class="n">nl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">continue</span>
    <span class="n">de</span> <span class="o">=</span> <span class="n">wdi_core</span><span class="o">.</span><span class="n">WDItemEngine</span><span class="o">.</span><span class="n">get_wd_search_results</span><span class="p">(</span><span class="n">institute</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="s1">&#39;de&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">de</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">instituteQID</span><span class="p">[</span><span class="n">institute</span><span class="p">]</span> <span class="o">=</span> <span class="n">de</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">continue</span>
    <span class="n">fr</span> <span class="o">=</span> <span class="n">wdi_core</span><span class="o">.</span><span class="n">WDItemEngine</span><span class="o">.</span><span class="n">get_wd_search_results</span><span class="p">(</span><span class="n">institute</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="s1">&#39;fr&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fr</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">instituteQID</span><span class="p">[</span><span class="n">institute</span><span class="p">]</span> <span class="o">=</span> <span class="n">fr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">continue</span>
    <span class="n">es</span> <span class="o">=</span> <span class="n">wdi_core</span><span class="o">.</span><span class="n">WDItemEngine</span><span class="o">.</span><span class="n">get_wd_search_results</span><span class="p">(</span><span class="n">institute</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="s1">&#39;es&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">es</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">instituteQID</span><span class="p">[</span><span class="n">institute</span><span class="p">]</span> <span class="o">=</span> <span class="n">es</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">continue</span>
    <span class="n">pt</span> <span class="o">=</span> <span class="n">wdi_core</span><span class="o">.</span><span class="n">WDItemEngine</span><span class="o">.</span><span class="n">get_wd_search_results</span><span class="p">(</span><span class="n">institute</span><span class="p">,</span> <span class="n">language</span><span class="o">=</span><span class="s1">&#39;pt&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pt</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">instituteQID</span><span class="p">[</span><span class="n">institute</span><span class="p">]</span> <span class="o">=</span> <span class="n">pt</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">continue</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
        <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="sa">f</span><span class="s2">&quot; Not found institute=</span><span class="si">{</span><span class="n">institute</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">notFound</span><span class="p">[</span><span class="n">institute</span><span class="p">]</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;https://api.gbif.org/v1/organization?q=&quot;</span><span class="o">+</span><span class="n">institute</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;University of Florida&#39;, &#39;Quentin Groom&#39;, &#39;Carnegie Museum of Natural History&#39;, &#39;The New York Botanical Garden&#39;, &#39;Sofie Meeus&#39;, nan, &#39;Delmaude C Ryan&#39;, &#39;Meise Botanic Garden&#39;, &#39;slauren&#39;, &#39;classical&#39;, &#39;gorillarebecca&#39;, &#39;monkeyjodey&#39;}
1 Not found institute=Delmaude C Ryan
2 Not found institute=slauren
3 Not found institute=gorillarebecca
4 Not found institute=monkeyjodey
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df2</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;taxonRank&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;SPECIES&quot;</span><span class="p">]</span>
<span class="n">df3</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[[</span><span class="s2">&quot;species&quot;</span><span class="p">,</span> <span class="s2">&quot;taxonKey&quot;</span><span class="p">,</span> <span class="s2">&quot;taxonRank&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
<span class="n">species_counts</span> <span class="o">=</span> <span class="n">df3</span><span class="p">[</span><span class="s2">&quot;species&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="n">species_counts</span>

<span class="n">grouped</span> <span class="o">=</span> <span class="n">df3</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;species&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">taxonKey</span><span class="p">))</span>
<span class="k">for</span> <span class="n">species</span><span class="p">,</span> <span class="n">taxon_keys</span> <span class="ow">in</span> <span class="n">grouped</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">taxon_keys</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">taxon_keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">taxon_keys</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Species: </span><span class="si">{</span><span class="n">species</span><span class="si">}</span><span class="s2">, Taxon Keys: </span><span class="si">{</span><span class="n">taxon_keys</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/nt/bqljt7p919zgfjwhldlsbdvh0000gn/T/ipykernel_69164/69063171.py:6: DeprecationWarning: DataFrameGroupBy.apply operated on the grouping columns. This behavior is deprecated, and in a future version of pandas the grouping columns will be excluded from the operation. Either pass `include_groups=False` to exclude the groupings or explicitly select the grouping columns after groupby to silence this warning.
  grouped = df3.groupby(&#39;species&#39;).apply(lambda x: list(x.taxonKey))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">taxonname</span> <span class="o">=</span>  <span class="n">df2</span><span class="p">[[</span><span class="s2">&quot;species&quot;</span><span class="p">,</span> <span class="s2">&quot;taxonKey&quot;</span><span class="p">,</span> <span class="s2">&quot;taxonRank&quot;</span><span class="p">,</span> <span class="s2">&quot;taxonRank&quot;</span><span class="p">,</span> <span class="s2">&quot;genus&quot;</span><span class="p">,</span> <span class="s2">&quot;genericName&quot;</span><span class="p">,</span><span class="s2">&quot;taxonomicStatus&quot;</span><span class="p">,</span> <span class="s2">&quot;acceptedNameUsageID&quot;</span><span class="p">,</span> <span class="s2">&quot;scientificName&quot;</span><span class="p">,</span> <span class="s2">&quot;specificEpithet&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
<span class="n">taxonnames</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">taxonname</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;specificEpithet&quot;</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">taxonnames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">+</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;genericName&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;specificEpithet&quot;</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="n">taxonnames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="o">+</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;genericName&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;specificEpithet&quot;</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">taxonnames</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">taxonnames</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="resolve-taxonnames-and-kingdom">
<h1>resolve taxonnames and kingdom<a class="headerlink" href="#resolve-taxonnames-and-kingdom" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://query.wikidata.org/sparql&#39;</span>
<span class="n">user_agent</span> <span class="o">=</span> <span class="s1">&#39;TaxonQueries/1.0 ( andra@micelio.be) SPARQL queries&#39;</span>  <span class="c1"># Replace with your actual User-Agent string</span>

<span class="n">result_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;taxonId&#39;</span><span class="p">,</span> <span class="s1">&#39;taxonname&#39;</span><span class="p">,</span> <span class="s1">&#39;taxon&#39;</span><span class="p">,</span> <span class="s1">&#39;kingdomname&#39;</span><span class="p">,</span> <span class="s1">&#39;kingdom&#39;</span> <span class="p">])</span>
<span class="n">batchSize</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">retry_wait_time</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Initial wait time in seconds</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">taxonnames</span><span class="p">)</span><span class="o">/</span><span class="n">batchSize</span><span class="p">)),</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Processing batches&quot;</span><span class="p">):</span>
    <span class="n">batch</span> <span class="o">=</span> <span class="n">taxonnames</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">batchSize</span><span class="p">:(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">batchSize</span><span class="p">]</span>
    <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">            SELECT ?taxon ?taxonId ?taxonname ?kingdomname ?kingdom ?article</span>
<span class="s2">                WHERE {</span>
<span class="s2">                    VALUES ?taxonname {&quot;&quot;&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&quot;&quot;}</span>
<span class="s2">                    ?taxon wdt:P225 ?taxonname .</span>
<span class="s2">                    ?taxon wdt:P171* ?kingdom .</span>
<span class="s2">                    OPTIONAL {?article schema:about ?taxon ;</span>
<span class="s2">                               schema:isPartOf &lt;https://en.wikipedia.org/&gt; .}</span>
<span class="s2">                    ?kingdom wdt:P105 wd:Q36732 .</span>
<span class="s2">                    ?kingdom rdfs:label ?kingdomname filter (lang(?kingdomname) = &quot;en&quot;) .</span>
<span class="s2">                    OPTIONAL {?taxon wdt:P846 ?taxonId .}</span>
<span class="s2">            }</span>
<span class="s2">            &quot;&quot;&quot;</span>
    <span class="c1"># print(query)</span>

    <span class="n">success</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">while</span> <span class="ow">not</span> <span class="n">success</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;User-Agent&#39;</span><span class="p">:</span> <span class="n">user_agent</span><span class="p">}</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;json&#39;</span><span class="p">,</span> <span class="s1">&#39;query&#39;</span><span class="p">:</span> <span class="n">query</span><span class="p">},</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
            <span class="n">r</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>  <span class="c1"># Raise an HTTPError for bad responses</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
            <span class="n">temp_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([(</span><span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;taxonId&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
                                     <span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;taxonname&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
                                     <span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;taxon&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
                                     <span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;kingdomname&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
                                     <span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;kingdom&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
                                     <span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;article&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                                    <span class="p">)</span>
                                    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;results&quot;</span><span class="p">][</span><span class="s2">&quot;bindings&quot;</span><span class="p">]],</span>
                                    <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;taxonId&#39;</span><span class="p">,</span> <span class="s1">&#39;taxonname&#39;</span><span class="p">,</span> <span class="s1">&#39;taxon&#39;</span><span class="p">,</span> <span class="s1">&#39;kingdomname&#39;</span><span class="p">,</span> <span class="s1">&#39;kingdom&#39;</span><span class="p">,</span> <span class="s1">&#39;article&#39;</span> <span class="p">])</span>

            <span class="c1"># Concatenate the temporary DataFrame with the main result DataFrame</span>
            <span class="n">result_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">result_df</span><span class="p">,</span> <span class="n">temp_df</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">success</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># Set to True to break out of the while loop on success</span>

        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error: </span><span class="si">{</span><span class="n">err</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Retrying in </span><span class="si">{</span><span class="n">retry_wait_time</span><span class="si">}</span><span class="s2"> seconds...&quot;</span><span class="p">)</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">retry_wait_time</span><span class="p">)</span>
            <span class="n">retry_wait_time</span> <span class="o">*=</span> <span class="mi">2</span>  <span class="c1"># Double the wait time</span>
            <span class="k">if</span> <span class="n">retry_wait_time</span> <span class="o">&gt;</span> <span class="mi">60</span><span class="p">:</span>  <span class="c1"># Limit the maximum wait time to 60 seconds</span>
                <span class="n">retry_wait_time</span> <span class="o">=</span> <span class="mi">60</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">retry_wait_time</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Reset to 1 second after a successful query</span>

<span class="c1"># Now, result_df contains all the data</span>
<span class="n">result_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing batches: 100%|██████████| 3/3 [00:01&lt;00:00,  2.38it/s]
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>taxonId</th>
      <th>taxonname</th>
      <th>taxon</th>
      <th>kingdomname</th>
      <th>kingdom</th>
      <th>article</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5289739</td>
      <td>Cenchrus echinatus</td>
      <td>http://www.wikidata.org/entity/Q4925284</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>https://en.wikipedia.org/wiki/Cenchrus_echinatus</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2704745</td>
      <td>Sporobolus virginicus</td>
      <td>http://www.wikidata.org/entity/Q7579252</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>https://en.wikipedia.org/wiki/Sporobolus_virgi...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2717421</td>
      <td>Eleocharis flavescens</td>
      <td>http://www.wikidata.org/entity/Q15584858</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>https://en.wikipedia.org/wiki/Eleocharis_flave...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2702504</td>
      <td>Melinis repens</td>
      <td>http://www.wikidata.org/entity/Q24700355</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>https://en.wikipedia.org/wiki/Melinis_repens</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2705068</td>
      <td>Panicum trichoides</td>
      <td>http://www.wikidata.org/entity/Q10912779</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td></td>
    </tr>
    <tr>
      <th>5</th>
      <td>2708680</td>
      <td>Fimbristylis complanata</td>
      <td>http://www.wikidata.org/entity/Q11075670</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td></td>
    </tr>
    <tr>
      <th>6</th>
      <td>2702854</td>
      <td>Lasiacis sorghoidea</td>
      <td>http://www.wikidata.org/entity/Q15508551</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td></td>
    </tr>
    <tr>
      <th>7</th>
      <td>2702852</td>
      <td>Lasiacis divaricata</td>
      <td>http://www.wikidata.org/entity/Q15508581</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td></td>
    </tr>
    <tr>
      <th>8</th>
      <td>2702522</td>
      <td>Eriochloa punctata</td>
      <td>http://www.wikidata.org/entity/Q15516186</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td></td>
    </tr>
    <tr>
      <th>9</th>
      <td>5291147</td>
      <td>Machaerina restioides</td>
      <td>http://www.wikidata.org/entity/Q15550242</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td></td>
    </tr>
    <tr>
      <th>10</th>
      <td>2705275</td>
      <td>Cymbopogon citratus</td>
      <td>http://www.wikidata.org/entity/Q33913</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>https://en.wikipedia.org/wiki/Cymbopogon_citratus</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2705758</td>
      <td>Bambusa vulgaris</td>
      <td>http://www.wikidata.org/entity/Q3219428</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>https://en.wikipedia.org/wiki/Bambusa_vulgaris</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2705656</td>
      <td>Paspalum conjugatum</td>
      <td>http://www.wikidata.org/entity/Q3367780</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>https://en.wikipedia.org/wiki/Paspalum_conjugatum</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2706277</td>
      <td>Aristida adscensionis</td>
      <td>http://www.wikidata.org/entity/Q4790962</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>https://en.wikipedia.org/wiki/Aristida_adscens...</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2706079</td>
      <td>Andropogon bicornis</td>
      <td>http://www.wikidata.org/entity/Q15504478</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td></td>
    </tr>
    <tr>
      <th>15</th>
      <td>2720622</td>
      <td>Rhynchospora tenerrima</td>
      <td>http://www.wikidata.org/entity/Q15557622</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td></td>
    </tr>
    <tr>
      <th>16</th>
      <td>2712691</td>
      <td>Scleria secans</td>
      <td>http://www.wikidata.org/entity/Q15564658</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td></td>
    </tr>
    <tr>
      <th>17</th>
      <td>2718767</td>
      <td>Cyperus brevifolius</td>
      <td>http://www.wikidata.org/entity/Q21265100</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td></td>
    </tr>
    <tr>
      <th>18</th>
      <td>2702936</td>
      <td>Anthephora hermaphrodita</td>
      <td>http://www.wikidata.org/entity/Q15504902</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>https://en.wikipedia.org/wiki/Anthephora_herma...</td>
    </tr>
    <tr>
      <th>19</th>
      <td>2715182</td>
      <td>Cyperus sphacelatus</td>
      <td>http://www.wikidata.org/entity/Q15535602</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>https://en.wikipedia.org/wiki/Cyperus_sphacelatus</td>
    </tr>
    <tr>
      <th>20</th>
      <td>5289968</td>
      <td>Digitaria bicornis</td>
      <td>http://www.wikidata.org/entity/Q11066188</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td></td>
    </tr>
    <tr>
      <th>21</th>
      <td>2705583</td>
      <td>Paspalum fimbriatum</td>
      <td>http://www.wikidata.org/entity/Q15246196</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td></td>
    </tr>
    <tr>
      <th>22</th>
      <td>2705827</td>
      <td>Brachiaria fasciculata</td>
      <td>http://www.wikidata.org/entity/Q15509620</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td></td>
    </tr>
    <tr>
      <th>23</th>
      <td>2721307</td>
      <td>Rhynchospora nervosa</td>
      <td>http://www.wikidata.org/entity/Q15555289</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td></td>
    </tr>
    <tr>
      <th>24</th>
      <td>2706301</td>
      <td>Coix lacryma-jobi</td>
      <td>http://www.wikidata.org/entity/Q827098</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>https://en.wikipedia.org/wiki/Job%27s_tears</td>
    </tr>
    <tr>
      <th>25</th>
      <td>2705924</td>
      <td>Axonopus compressus</td>
      <td>http://www.wikidata.org/entity/Q4830676</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>https://en.wikipedia.org/wiki/Axonopus_compressus</td>
    </tr>
    <tr>
      <th>26</th>
      <td>2715045</td>
      <td>Cyperus alopecuroides</td>
      <td>http://www.wikidata.org/entity/Q6539452</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>https://en.wikipedia.org/wiki/Cyperus_alopecur...</td>
    </tr>
    <tr>
      <th>27</th>
      <td>5289938</td>
      <td>Digitaria insularis</td>
      <td>http://www.wikidata.org/entity/Q14834635</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>https://en.wikipedia.org/wiki/Digitaria_insularis</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="merge-taxonnames-and-kingdom">
<h1>Merge taxonnames and kingdom<a class="headerlink" href="#merge-taxonnames-and-kingdom" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result_df</span><span class="p">[[</span><span class="s1">&#39;genericName&#39;</span><span class="p">,</span> <span class="s1">&#39;specificEpithet&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">result_df</span><span class="p">[</span><span class="s1">&#39;taxonname&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Print the updated DataFrame</span>
<span class="n">wdtaxqid</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">result_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;taxonId&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="n">wdtaxqid</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;taxonId&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;taxon&quot;</span><span class="p">]</span>
<span class="n">result_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>taxonId</th>
      <th>taxonname</th>
      <th>taxon</th>
      <th>kingdomname</th>
      <th>kingdom</th>
      <th>article</th>
      <th>genericName</th>
      <th>specificEpithet</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5289739</td>
      <td>Cenchrus echinatus</td>
      <td>http://www.wikidata.org/entity/Q4925284</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>https://en.wikipedia.org/wiki/Cenchrus_echinatus</td>
      <td>Cenchrus</td>
      <td>echinatus</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2704745</td>
      <td>Sporobolus virginicus</td>
      <td>http://www.wikidata.org/entity/Q7579252</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>https://en.wikipedia.org/wiki/Sporobolus_virgi...</td>
      <td>Sporobolus</td>
      <td>virginicus</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2717421</td>
      <td>Eleocharis flavescens</td>
      <td>http://www.wikidata.org/entity/Q15584858</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>https://en.wikipedia.org/wiki/Eleocharis_flave...</td>
      <td>Eleocharis</td>
      <td>flavescens</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2702504</td>
      <td>Melinis repens</td>
      <td>http://www.wikidata.org/entity/Q24700355</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>https://en.wikipedia.org/wiki/Melinis_repens</td>
      <td>Melinis</td>
      <td>repens</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2705068</td>
      <td>Panicum trichoides</td>
      <td>http://www.wikidata.org/entity/Q10912779</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td></td>
      <td>Panicum</td>
      <td>trichoides</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2708680</td>
      <td>Fimbristylis complanata</td>
      <td>http://www.wikidata.org/entity/Q11075670</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td></td>
      <td>Fimbristylis</td>
      <td>complanata</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2702854</td>
      <td>Lasiacis sorghoidea</td>
      <td>http://www.wikidata.org/entity/Q15508551</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td></td>
      <td>Lasiacis</td>
      <td>sorghoidea</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2702852</td>
      <td>Lasiacis divaricata</td>
      <td>http://www.wikidata.org/entity/Q15508581</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td></td>
      <td>Lasiacis</td>
      <td>divaricata</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2702522</td>
      <td>Eriochloa punctata</td>
      <td>http://www.wikidata.org/entity/Q15516186</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td></td>
      <td>Eriochloa</td>
      <td>punctata</td>
    </tr>
    <tr>
      <th>9</th>
      <td>5291147</td>
      <td>Machaerina restioides</td>
      <td>http://www.wikidata.org/entity/Q15550242</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td></td>
      <td>Machaerina</td>
      <td>restioides</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2705275</td>
      <td>Cymbopogon citratus</td>
      <td>http://www.wikidata.org/entity/Q33913</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>https://en.wikipedia.org/wiki/Cymbopogon_citratus</td>
      <td>Cymbopogon</td>
      <td>citratus</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2705758</td>
      <td>Bambusa vulgaris</td>
      <td>http://www.wikidata.org/entity/Q3219428</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>https://en.wikipedia.org/wiki/Bambusa_vulgaris</td>
      <td>Bambusa</td>
      <td>vulgaris</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2705656</td>
      <td>Paspalum conjugatum</td>
      <td>http://www.wikidata.org/entity/Q3367780</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>https://en.wikipedia.org/wiki/Paspalum_conjugatum</td>
      <td>Paspalum</td>
      <td>conjugatum</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2706277</td>
      <td>Aristida adscensionis</td>
      <td>http://www.wikidata.org/entity/Q4790962</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>https://en.wikipedia.org/wiki/Aristida_adscens...</td>
      <td>Aristida</td>
      <td>adscensionis</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2706079</td>
      <td>Andropogon bicornis</td>
      <td>http://www.wikidata.org/entity/Q15504478</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td></td>
      <td>Andropogon</td>
      <td>bicornis</td>
    </tr>
    <tr>
      <th>15</th>
      <td>2720622</td>
      <td>Rhynchospora tenerrima</td>
      <td>http://www.wikidata.org/entity/Q15557622</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td></td>
      <td>Rhynchospora</td>
      <td>tenerrima</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2712691</td>
      <td>Scleria secans</td>
      <td>http://www.wikidata.org/entity/Q15564658</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td></td>
      <td>Scleria</td>
      <td>secans</td>
    </tr>
    <tr>
      <th>17</th>
      <td>2718767</td>
      <td>Cyperus brevifolius</td>
      <td>http://www.wikidata.org/entity/Q21265100</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td></td>
      <td>Cyperus</td>
      <td>brevifolius</td>
    </tr>
    <tr>
      <th>18</th>
      <td>2702936</td>
      <td>Anthephora hermaphrodita</td>
      <td>http://www.wikidata.org/entity/Q15504902</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>https://en.wikipedia.org/wiki/Anthephora_herma...</td>
      <td>Anthephora</td>
      <td>hermaphrodita</td>
    </tr>
    <tr>
      <th>19</th>
      <td>2715182</td>
      <td>Cyperus sphacelatus</td>
      <td>http://www.wikidata.org/entity/Q15535602</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>https://en.wikipedia.org/wiki/Cyperus_sphacelatus</td>
      <td>Cyperus</td>
      <td>sphacelatus</td>
    </tr>
    <tr>
      <th>20</th>
      <td>5289968</td>
      <td>Digitaria bicornis</td>
      <td>http://www.wikidata.org/entity/Q11066188</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td></td>
      <td>Digitaria</td>
      <td>bicornis</td>
    </tr>
    <tr>
      <th>21</th>
      <td>2705583</td>
      <td>Paspalum fimbriatum</td>
      <td>http://www.wikidata.org/entity/Q15246196</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td></td>
      <td>Paspalum</td>
      <td>fimbriatum</td>
    </tr>
    <tr>
      <th>22</th>
      <td>2705827</td>
      <td>Brachiaria fasciculata</td>
      <td>http://www.wikidata.org/entity/Q15509620</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td></td>
      <td>Brachiaria</td>
      <td>fasciculata</td>
    </tr>
    <tr>
      <th>23</th>
      <td>2721307</td>
      <td>Rhynchospora nervosa</td>
      <td>http://www.wikidata.org/entity/Q15555289</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td></td>
      <td>Rhynchospora</td>
      <td>nervosa</td>
    </tr>
    <tr>
      <th>24</th>
      <td>2706301</td>
      <td>Coix lacryma-jobi</td>
      <td>http://www.wikidata.org/entity/Q827098</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>https://en.wikipedia.org/wiki/Job%27s_tears</td>
      <td>Coix</td>
      <td>lacryma-jobi</td>
    </tr>
    <tr>
      <th>25</th>
      <td>2705924</td>
      <td>Axonopus compressus</td>
      <td>http://www.wikidata.org/entity/Q4830676</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>https://en.wikipedia.org/wiki/Axonopus_compressus</td>
      <td>Axonopus</td>
      <td>compressus</td>
    </tr>
    <tr>
      <th>26</th>
      <td>2715045</td>
      <td>Cyperus alopecuroides</td>
      <td>http://www.wikidata.org/entity/Q6539452</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>https://en.wikipedia.org/wiki/Cyperus_alopecur...</td>
      <td>Cyperus</td>
      <td>alopecuroides</td>
    </tr>
    <tr>
      <th>27</th>
      <td>5289938</td>
      <td>Digitaria insularis</td>
      <td>http://www.wikidata.org/entity/Q14834635</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>https://en.wikipedia.org/wiki/Digitaria_insularis</td>
      <td>Digitaria</td>
      <td>insularis</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">result_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;genericName&#39;</span><span class="p">,</span> <span class="s1">&#39;specificEpithet&#39;</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">)</span>
<span class="n">merged_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gbifID</th>
      <th>accessRights</th>
      <th>bibliographicCitation</th>
      <th>language</th>
      <th>license</th>
      <th>modified</th>
      <th>publisher</th>
      <th>references</th>
      <th>rightsHolder</th>
      <th>type</th>
      <th>...</th>
      <th>level2Name</th>
      <th>level3Gid</th>
      <th>level3Name</th>
      <th>iucnRedListCategory</th>
      <th>taxonId</th>
      <th>taxonname</th>
      <th>taxon</th>
      <th>kingdomname</th>
      <th>kingdom_y</th>
      <th>article</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4876300936</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CC_BY_4_0</td>
      <td>2023-03-20T00:00:00Z</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Meise Botanic Garden</td>
      <td>PhysicalObject</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LC</td>
      <td>2718767</td>
      <td>Cyperus brevifolius</td>
      <td>http://www.wikidata.org/entity/Q21265100</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>4876284841</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CC_BY_4_0</td>
      <td>2023-03-21T00:00:00Z</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Meise Botanic Garden</td>
      <td>PhysicalObject</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NE</td>
      <td>2721307</td>
      <td>Rhynchospora nervosa</td>
      <td>http://www.wikidata.org/entity/Q15555289</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>4607368012</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CC_BY_NC_4_0</td>
      <td>2024-05-24T09:26:47Z</td>
      <td>NaN</td>
      <td>https://www.inaturalist.org/observations/20511...</td>
      <td>slauren</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NE</td>
      <td>2702504</td>
      <td>Melinis repens</td>
      <td>http://www.wikidata.org/entity/Q24700355</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>https://en.wikipedia.org/wiki/Melinis_repens</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4536015362</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CC0_1_0</td>
      <td>2024-04-26T16:57:26Z</td>
      <td>NaN</td>
      <td>https://www.inaturalist.org/observations/20102...</td>
      <td>monkeyjodey</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NE</td>
      <td>2702504</td>
      <td>Melinis repens</td>
      <td>http://www.wikidata.org/entity/Q24700355</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>https://en.wikipedia.org/wiki/Melinis_repens</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4536000017</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CC0_1_0</td>
      <td>2024-04-26T16:57:26Z</td>
      <td>NaN</td>
      <td>https://www.inaturalist.org/observations/20125...</td>
      <td>monkeyjodey</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NE</td>
      <td>2702504</td>
      <td>Melinis repens</td>
      <td>http://www.wikidata.org/entity/Q24700355</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>https://en.wikipedia.org/wiki/Melinis_repens</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>82</th>
      <td>1319347135</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CC0_1_0</td>
      <td>2017-10-31T12:14:00Z</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LC</td>
      <td>2712691</td>
      <td>Scleria secans</td>
      <td>http://www.wikidata.org/entity/Q15564658</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td></td>
    </tr>
    <tr>
      <th>83</th>
      <td>1318020074</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CC0_1_0</td>
      <td>2017-10-31T12:10:00Z</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NE</td>
      <td>2715182</td>
      <td>Cyperus sphacelatus</td>
      <td>http://www.wikidata.org/entity/Q15535602</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>https://en.wikipedia.org/wiki/Cyperus_sphacelatus</td>
    </tr>
    <tr>
      <th>84</th>
      <td>1317614158</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CC0_1_0</td>
      <td>2021-03-06T11:43:00Z</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NE</td>
      <td>2705827</td>
      <td>Brachiaria fasciculata</td>
      <td>http://www.wikidata.org/entity/Q15509620</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td></td>
    </tr>
    <tr>
      <th>85</th>
      <td>1317605282</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CC0_1_0</td>
      <td>2021-03-08T09:38:00Z</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NE</td>
      <td>2702854</td>
      <td>Lasiacis sorghoidea</td>
      <td>http://www.wikidata.org/entity/Q15508551</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td></td>
    </tr>
    <tr>
      <th>86</th>
      <td>1056947532</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CC0_1_0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NE</td>
      <td>5291147</td>
      <td>Machaerina restioides</td>
      <td>http://www.wikidata.org/entity/Q15550242</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td></td>
    </tr>
  </tbody>
</table>
<p>87 rows × 229 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged_df</span><span class="p">[[</span><span class="s1">&#39;taxonKey&#39;</span><span class="p">,</span> <span class="s1">&#39;taxonId&#39;</span><span class="p">,</span> <span class="s1">&#39;taxonname&#39;</span><span class="p">,</span> <span class="s1">&#39;taxon&#39;</span><span class="p">,</span> <span class="s1">&#39;genericName&#39;</span><span class="p">,</span> <span class="s1">&#39;specificEpithet&#39;</span><span class="p">,</span> <span class="s1">&#39;kingdom_y&#39;</span><span class="p">,</span> <span class="s1">&#39;kingdomname&#39;</span><span class="p">,</span> <span class="s1">&#39;article&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>taxonKey</th>
      <th>taxonId</th>
      <th>taxonname</th>
      <th>taxon</th>
      <th>genericName</th>
      <th>specificEpithet</th>
      <th>kingdom_y</th>
      <th>kingdomname</th>
      <th>article</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2718767</td>
      <td>2718767</td>
      <td>Cyperus brevifolius</td>
      <td>http://www.wikidata.org/entity/Q21265100</td>
      <td>Cyperus</td>
      <td>brevifolius</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>plant</td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td>2721307</td>
      <td>2721307</td>
      <td>Rhynchospora nervosa</td>
      <td>http://www.wikidata.org/entity/Q15555289</td>
      <td>Rhynchospora</td>
      <td>nervosa</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>plant</td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td>2702504</td>
      <td>2702504</td>
      <td>Melinis repens</td>
      <td>http://www.wikidata.org/entity/Q24700355</td>
      <td>Melinis</td>
      <td>repens</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>plant</td>
      <td>https://en.wikipedia.org/wiki/Melinis_repens</td>
    </tr>
    <tr>
      <th>5</th>
      <td>7661971</td>
      <td>2705758</td>
      <td>Bambusa vulgaris</td>
      <td>http://www.wikidata.org/entity/Q3219428</td>
      <td>Bambusa</td>
      <td>vulgaris</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>plant</td>
      <td>https://en.wikipedia.org/wiki/Bambusa_vulgaris</td>
    </tr>
    <tr>
      <th>9</th>
      <td>5289739</td>
      <td>5289739</td>
      <td>Cenchrus echinatus</td>
      <td>http://www.wikidata.org/entity/Q4925284</td>
      <td>Cenchrus</td>
      <td>echinatus</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>plant</td>
      <td>https://en.wikipedia.org/wiki/Cenchrus_echinatus</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2702852</td>
      <td>2702852</td>
      <td>Lasiacis divaricata</td>
      <td>http://www.wikidata.org/entity/Q15508581</td>
      <td>Lasiacis</td>
      <td>divaricata</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>plant</td>
      <td></td>
    </tr>
    <tr>
      <th>15</th>
      <td>2715182</td>
      <td>2715182</td>
      <td>Cyperus sphacelatus</td>
      <td>http://www.wikidata.org/entity/Q15535602</td>
      <td>Cyperus</td>
      <td>sphacelatus</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>plant</td>
      <td>https://en.wikipedia.org/wiki/Cyperus_sphacelatus</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2704745</td>
      <td>2704745</td>
      <td>Sporobolus virginicus</td>
      <td>http://www.wikidata.org/entity/Q7579252</td>
      <td>Sporobolus</td>
      <td>virginicus</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>plant</td>
      <td>https://en.wikipedia.org/wiki/Sporobolus_virgi...</td>
    </tr>
    <tr>
      <th>19</th>
      <td>2705924</td>
      <td>2705924</td>
      <td>Axonopus compressus</td>
      <td>http://www.wikidata.org/entity/Q4830676</td>
      <td>Axonopus</td>
      <td>compressus</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>plant</td>
      <td>https://en.wikipedia.org/wiki/Axonopus_compressus</td>
    </tr>
    <tr>
      <th>22</th>
      <td>2717421</td>
      <td>2717421</td>
      <td>Eleocharis flavescens</td>
      <td>http://www.wikidata.org/entity/Q15584858</td>
      <td>Eleocharis</td>
      <td>flavescens</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>plant</td>
      <td>https://en.wikipedia.org/wiki/Eleocharis_flave...</td>
    </tr>
    <tr>
      <th>23</th>
      <td>2702522</td>
      <td>2702522</td>
      <td>Eriochloa punctata</td>
      <td>http://www.wikidata.org/entity/Q15516186</td>
      <td>Eriochloa</td>
      <td>punctata</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>plant</td>
      <td></td>
    </tr>
    <tr>
      <th>24</th>
      <td>5291147</td>
      <td>5291147</td>
      <td>Machaerina restioides</td>
      <td>http://www.wikidata.org/entity/Q15550242</td>
      <td>Machaerina</td>
      <td>restioides</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>plant</td>
      <td></td>
    </tr>
    <tr>
      <th>25</th>
      <td>2712691</td>
      <td>2712691</td>
      <td>Scleria secans</td>
      <td>http://www.wikidata.org/entity/Q15564658</td>
      <td>Scleria</td>
      <td>secans</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>plant</td>
      <td></td>
    </tr>
    <tr>
      <th>26</th>
      <td>2708680</td>
      <td>2708680</td>
      <td>Fimbristylis complanata</td>
      <td>http://www.wikidata.org/entity/Q11075670</td>
      <td>Fimbristylis</td>
      <td>complanata</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>plant</td>
      <td></td>
    </tr>
    <tr>
      <th>29</th>
      <td>2705583</td>
      <td>2705583</td>
      <td>Paspalum fimbriatum</td>
      <td>http://www.wikidata.org/entity/Q15246196</td>
      <td>Paspalum</td>
      <td>fimbriatum</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>plant</td>
      <td></td>
    </tr>
    <tr>
      <th>30</th>
      <td>2702854</td>
      <td>2702854</td>
      <td>Lasiacis sorghoidea</td>
      <td>http://www.wikidata.org/entity/Q15508551</td>
      <td>Lasiacis</td>
      <td>sorghoidea</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>plant</td>
      <td></td>
    </tr>
    <tr>
      <th>33</th>
      <td>7226846</td>
      <td>2702852</td>
      <td>Lasiacis divaricata</td>
      <td>http://www.wikidata.org/entity/Q15508581</td>
      <td>Lasiacis</td>
      <td>divaricata</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>plant</td>
      <td></td>
    </tr>
    <tr>
      <th>34</th>
      <td>5289938</td>
      <td>5289938</td>
      <td>Digitaria insularis</td>
      <td>http://www.wikidata.org/entity/Q14834635</td>
      <td>Digitaria</td>
      <td>insularis</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>plant</td>
      <td>https://en.wikipedia.org/wiki/Digitaria_insularis</td>
    </tr>
    <tr>
      <th>35</th>
      <td>2702936</td>
      <td>2702936</td>
      <td>Anthephora hermaphrodita</td>
      <td>http://www.wikidata.org/entity/Q15504902</td>
      <td>Anthephora</td>
      <td>hermaphrodita</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>plant</td>
      <td>https://en.wikipedia.org/wiki/Anthephora_herma...</td>
    </tr>
    <tr>
      <th>37</th>
      <td>2705068</td>
      <td>2705068</td>
      <td>Panicum trichoides</td>
      <td>http://www.wikidata.org/entity/Q10912779</td>
      <td>Panicum</td>
      <td>trichoides</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>plant</td>
      <td></td>
    </tr>
    <tr>
      <th>38</th>
      <td>2705656</td>
      <td>2705656</td>
      <td>Paspalum conjugatum</td>
      <td>http://www.wikidata.org/entity/Q3367780</td>
      <td>Paspalum</td>
      <td>conjugatum</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>plant</td>
      <td>https://en.wikipedia.org/wiki/Paspalum_conjugatum</td>
    </tr>
    <tr>
      <th>39</th>
      <td>2705275</td>
      <td>2705275</td>
      <td>Cymbopogon citratus</td>
      <td>http://www.wikidata.org/entity/Q33913</td>
      <td>Cymbopogon</td>
      <td>citratus</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>plant</td>
      <td>https://en.wikipedia.org/wiki/Cymbopogon_citratus</td>
    </tr>
    <tr>
      <th>45</th>
      <td>2706079</td>
      <td>2706079</td>
      <td>Andropogon bicornis</td>
      <td>http://www.wikidata.org/entity/Q15504478</td>
      <td>Andropogon</td>
      <td>bicornis</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>plant</td>
      <td></td>
    </tr>
    <tr>
      <th>48</th>
      <td>2715045</td>
      <td>2715045</td>
      <td>Cyperus alopecuroides</td>
      <td>http://www.wikidata.org/entity/Q6539452</td>
      <td>Cyperus</td>
      <td>alopecuroides</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>plant</td>
      <td>https://en.wikipedia.org/wiki/Cyperus_alopecur...</td>
    </tr>
    <tr>
      <th>50</th>
      <td>2706301</td>
      <td>2706301</td>
      <td>Coix lacryma-jobi</td>
      <td>http://www.wikidata.org/entity/Q827098</td>
      <td>Coix</td>
      <td>lacryma-jobi</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>plant</td>
      <td>https://en.wikipedia.org/wiki/Job%27s_tears</td>
    </tr>
    <tr>
      <th>51</th>
      <td>2706277</td>
      <td>2706277</td>
      <td>Aristida adscensionis</td>
      <td>http://www.wikidata.org/entity/Q4790962</td>
      <td>Aristida</td>
      <td>adscensionis</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>plant</td>
      <td>https://en.wikipedia.org/wiki/Aristida_adscens...</td>
    </tr>
    <tr>
      <th>59</th>
      <td>2720622</td>
      <td>2720622</td>
      <td>Rhynchospora tenerrima</td>
      <td>http://www.wikidata.org/entity/Q15557622</td>
      <td>Rhynchospora</td>
      <td>tenerrima</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>plant</td>
      <td></td>
    </tr>
    <tr>
      <th>77</th>
      <td>5289968</td>
      <td>5289968</td>
      <td>Digitaria bicornis</td>
      <td>http://www.wikidata.org/entity/Q11066188</td>
      <td>Digitaria</td>
      <td>bicornis</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>plant</td>
      <td></td>
    </tr>
    <tr>
      <th>84</th>
      <td>2705827</td>
      <td>2705827</td>
      <td>Brachiaria fasciculata</td>
      <td>http://www.wikidata.org/entity/Q15509620</td>
      <td>Brachiaria</td>
      <td>fasciculata</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>plant</td>
      <td></td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">taxoninformation</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">get_wikipedia_snippet</span><span class="p">(</span><span class="n">title</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://en.wikipedia.org/w/api.php&quot;</span>
    <span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;query&quot;</span><span class="p">,</span>
        <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;json&quot;</span><span class="p">,</span>
        <span class="s2">&quot;titles&quot;</span><span class="p">:</span> <span class="n">title</span><span class="p">,</span>
        <span class="s2">&quot;prop&quot;</span><span class="p">:</span> <span class="s2">&quot;extracts&quot;</span><span class="p">,</span>
        <span class="s2">&quot;exintro&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;explaintext&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s2">&quot;redirects&quot;</span><span class="p">:</span> <span class="mi">1</span>
    <span class="p">}</span>
    <span class="k">for</span> <span class="n">attempt</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="mi">200</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">attempt</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
            <span class="n">page</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;query&quot;</span><span class="p">][</span><span class="s2">&quot;pages&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
            <span class="k">return</span> <span class="n">page</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;extract&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">attempt</span><span class="p">)</span>
    <span class="k">return</span> <span class="s2">&quot;&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Assuming `result_df` is your DataFrame and it has columns named &#39;article&#39; and &#39;taxonname&#39;</span>
<span class="n">taxonname_list</span> <span class="o">=</span> <span class="n">result_df</span><span class="p">[</span><span class="n">result_df</span><span class="p">[</span><span class="s2">&quot;article&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">][</span><span class="s2">&quot;taxonname&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">taxonname_list</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Cenchrus echinatus&#39;,
 &#39;Sporobolus virginicus&#39;,
 &#39;Eleocharis flavescens&#39;,
 &#39;Melinis repens&#39;,
 &#39;Cymbopogon citratus&#39;,
 &#39;Bambusa vulgaris&#39;,
 &#39;Paspalum conjugatum&#39;,
 &#39;Aristida adscensionis&#39;,
 &#39;Anthephora hermaphrodita&#39;,
 &#39;Cyperus sphacelatus&#39;,
 &#39;Coix lacryma-jobi&#39;,
 &#39;Axonopus compressus&#39;,
 &#39;Cyperus alopecuroides&#39;,
 &#39;Digitaria insularis&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">taxonname</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span><span class="n">taxonname_list</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">taxonname</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">taxoninformation</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">taxoninformation</span><span class="p">[</span><span class="n">taxonname</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">taxoninformation</span><span class="p">[</span><span class="n">taxonname</span><span class="p">][</span><span class="s2">&quot;wikiintroduction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_wikipedia_snippet</span><span class="p">(</span><span class="n">taxonname</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;_&quot;</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: could not fetch Wikipedia snippet for </span><span class="si">{</span><span class="n">taxonname</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">taxoninformation</span><span class="p">[</span><span class="n">taxonname</span><span class="p">][</span><span class="s2">&quot;wikiintroduction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>  <span class="c1"># be polite to the Wikipedia API</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 14/14 [00:04&lt;00:00,  3.33it/s]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">taxon_info_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">taxoninformation</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">taxon_info_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;index&#39;</span><span class="p">:</span> <span class="s1">&#39;taxonname&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Merge the dictionary DataFrame with your existing DataFrame</span>
<span class="n">merged_df2</span> <span class="o">=</span> <span class="n">merged_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">taxon_info_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;taxonname&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">merged_df2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gbifID</th>
      <th>accessRights</th>
      <th>bibliographicCitation</th>
      <th>language</th>
      <th>license</th>
      <th>modified</th>
      <th>publisher</th>
      <th>references</th>
      <th>rightsHolder</th>
      <th>type</th>
      <th>...</th>
      <th>level3Gid</th>
      <th>level3Name</th>
      <th>iucnRedListCategory</th>
      <th>taxonId</th>
      <th>taxonname</th>
      <th>taxon</th>
      <th>kingdomname</th>
      <th>kingdom_y</th>
      <th>article</th>
      <th>wikiintroduction</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4876300936</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CC_BY_4_0</td>
      <td>2023-03-20T00:00:00Z</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Meise Botanic Garden</td>
      <td>PhysicalObject</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LC</td>
      <td>2718767</td>
      <td>Cyperus brevifolius</td>
      <td>http://www.wikidata.org/entity/Q21265100</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td></td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4876284841</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CC_BY_4_0</td>
      <td>2023-03-21T00:00:00Z</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Meise Botanic Garden</td>
      <td>PhysicalObject</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NE</td>
      <td>2721307</td>
      <td>Rhynchospora nervosa</td>
      <td>http://www.wikidata.org/entity/Q15555289</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td></td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4607368012</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CC_BY_NC_4_0</td>
      <td>2024-05-24T09:26:47Z</td>
      <td>NaN</td>
      <td>https://www.inaturalist.org/observations/20511...</td>
      <td>slauren</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NE</td>
      <td>2702504</td>
      <td>Melinis repens</td>
      <td>http://www.wikidata.org/entity/Q24700355</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>https://en.wikipedia.org/wiki/Melinis_repens</td>
      <td>Melinis repens is a species of grass known by ...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4536015362</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CC0_1_0</td>
      <td>2024-04-26T16:57:26Z</td>
      <td>NaN</td>
      <td>https://www.inaturalist.org/observations/20102...</td>
      <td>monkeyjodey</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NE</td>
      <td>2702504</td>
      <td>Melinis repens</td>
      <td>http://www.wikidata.org/entity/Q24700355</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>https://en.wikipedia.org/wiki/Melinis_repens</td>
      <td>Melinis repens is a species of grass known by ...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4536000017</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CC0_1_0</td>
      <td>2024-04-26T16:57:26Z</td>
      <td>NaN</td>
      <td>https://www.inaturalist.org/observations/20125...</td>
      <td>monkeyjodey</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NE</td>
      <td>2702504</td>
      <td>Melinis repens</td>
      <td>http://www.wikidata.org/entity/Q24700355</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>https://en.wikipedia.org/wiki/Melinis_repens</td>
      <td>Melinis repens is a species of grass known by ...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>82</th>
      <td>1319347135</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CC0_1_0</td>
      <td>2017-10-31T12:14:00Z</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>LC</td>
      <td>2712691</td>
      <td>Scleria secans</td>
      <td>http://www.wikidata.org/entity/Q15564658</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td></td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>83</th>
      <td>1318020074</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CC0_1_0</td>
      <td>2017-10-31T12:10:00Z</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NE</td>
      <td>2715182</td>
      <td>Cyperus sphacelatus</td>
      <td>http://www.wikidata.org/entity/Q15535602</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td>https://en.wikipedia.org/wiki/Cyperus_sphacelatus</td>
      <td>Cyperus sphacelatus is a species of sedge that...</td>
    </tr>
    <tr>
      <th>84</th>
      <td>1317614158</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CC0_1_0</td>
      <td>2021-03-06T11:43:00Z</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NE</td>
      <td>2705827</td>
      <td>Brachiaria fasciculata</td>
      <td>http://www.wikidata.org/entity/Q15509620</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td></td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>85</th>
      <td>1317605282</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CC0_1_0</td>
      <td>2021-03-08T09:38:00Z</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NE</td>
      <td>2702854</td>
      <td>Lasiacis sorghoidea</td>
      <td>http://www.wikidata.org/entity/Q15508551</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td></td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>86</th>
      <td>1056947532</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>CC0_1_0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NE</td>
      <td>5291147</td>
      <td>Machaerina restioides</td>
      <td>http://www.wikidata.org/entity/Q15550242</td>
      <td>plant</td>
      <td>http://www.wikidata.org/entity/Q756</td>
      <td></td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>87 rows × 230 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gbifRDF</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>
<span class="n">WD</span> <span class="o">=</span> <span class="n">Namespace</span><span class="p">(</span><span class="s2">&quot;http://www.wikidata.org/entity/&quot;</span><span class="p">)</span>
<span class="n">WDT</span> <span class="o">=</span> <span class="n">Namespace</span><span class="p">(</span><span class="s2">&quot;http://www.wikidata.org/prop/direct/&quot;</span><span class="p">)</span>
<span class="n">gbifRDF</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;wd&quot;</span><span class="p">,</span> <span class="n">WD</span><span class="p">)</span>
<span class="n">gbifRDF</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;wdt&quot;</span><span class="p">,</span> <span class="n">WDT</span><span class="p">)</span>
<span class="n">gbifRDF</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;dcterms&quot;</span><span class="p">,</span> <span class="n">DCTERMS</span><span class="p">)</span>
<span class="n">gbifRDF</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="s2">&quot;geo&quot;</span><span class="p">,</span> <span class="n">Namespace</span><span class="p">(</span><span class="s2">&quot;http://www.opengis.net/ont/geosparql#&quot;</span><span class="p">))</span>

<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span><span class="n">merged_df2</span><span class="o">.</span><span class="n">iterrows</span><span class="p">()):</span>
    <span class="n">GBIFURI</span> <span class="o">=</span> <span class="n">URIRef</span><span class="p">(</span><span class="s2">&quot;https://gbif.semscape.org/occurrence/&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;gbifID&quot;</span><span class="p">]))</span>
    <span class="n">gbifRDF</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">GBIFURI</span><span class="p">,</span> <span class="n">WDT</span><span class="o">.</span><span class="n">P854</span> <span class="p">,</span> <span class="n">URIRef</span><span class="p">(</span><span class="s2">&quot;https://www.gbif.org/occurrence/&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;gbifID&quot;</span><span class="p">]))))</span>
    <span class="n">gbifRDF</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">GBIFURI</span><span class="p">,</span> <span class="n">DCTERMS</span><span class="o">.</span><span class="n">identifier</span> <span class="p">,</span> <span class="n">Literal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;gbifID&quot;</span><span class="p">]))))</span>

    <span class="c1"># species</span>
    <span class="n">tempkey</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;taxonKey&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.0&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">tempkey</span> <span class="ow">in</span> <span class="n">wdtaxqid</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">gbifRDF</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">GBIFURI</span><span class="p">,</span> <span class="n">WDT</span><span class="o">.</span><span class="n">P225</span><span class="p">,</span> <span class="n">URIRef</span><span class="p">(</span><span class="n">wdtaxqid</span><span class="p">[</span><span class="n">tempkey</span><span class="p">])))</span>
        <span class="n">gbifRDF</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">URIRef</span><span class="p">(</span><span class="n">wdtaxqid</span><span class="p">[</span><span class="n">tempkey</span><span class="p">]),</span> <span class="n">RDFS</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="n">Literal</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;taxonname&quot;</span><span class="p">],</span> <span class="n">lang</span><span class="o">=</span><span class="s2">&quot;en&quot;</span><span class="p">)))</span>

    <span class="c1"># lat long</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;decimalLatitude&quot;</span><span class="p">])):</span>
            <span class="n">gbifRDF</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">GBIFURI</span><span class="p">,</span> <span class="n">WDT</span><span class="o">.</span><span class="n">P625</span><span class="p">,</span> <span class="n">Literal</span><span class="p">(</span><span class="s2">&quot;Point(&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;decimalLongitude&quot;</span><span class="p">])</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;decimalLatitude&quot;</span><span class="p">])</span><span class="o">+</span><span class="s2">&quot;)&quot;</span><span class="p">,</span> <span class="n">datatype</span><span class="o">=</span><span class="s2">&quot;http://www.opengis.net/ont/geosparql#wktLiteral&quot;</span><span class="p">)))</span>
    <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">)</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error for gbifID=</span><span class="si">{</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;gbifID&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, Latitude=</span><span class="si">{</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;decimalLatitude&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">, Longitude=</span><span class="si">{</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;decimalLongitude&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error details: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error occurred in this line: </span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">__traceback__</span><span class="o">.</span><span class="n">tb_lineno</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># type</span>
    <span class="n">typeDict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;Collection&quot;</span><span class="p">:</span> <span class="s2">&quot;Q2668072&quot;</span><span class="p">,</span><span class="s2">&quot;Colletion&quot;</span><span class="p">:</span> <span class="s2">&quot;Q2668072&quot;</span><span class="p">,</span><span class="s2">&quot;collection&quot;</span><span class="p">:</span> <span class="s2">&quot;Q2668072&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Event&quot;</span><span class="p">:</span> <span class="s2">&quot;Q1656682&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Objeto físico&quot;</span><span class="p">:</span> <span class="s2">&quot;Q223557&quot;</span><span class="p">,</span><span class="s2">&quot;Physical Object&quot;</span><span class="p">:</span> <span class="s2">&quot;Q223557&quot;</span><span class="p">,</span><span class="s2">&quot;Physical object&quot;</span><span class="p">:</span> <span class="s2">&quot;Q223557&quot;</span><span class="p">,</span><span class="s2">&quot;PhysicalObject&quot;</span><span class="p">:</span> <span class="s2">&quot;Q223557&quot;</span><span class="p">,</span><span class="s2">&quot;PhysicalSpecimen&quot;</span><span class="p">:</span> <span class="s2">&quot;Q223557&quot;</span><span class="p">,</span><span class="s2">&quot;http://purl.org/dc/dcmitype/PhysicalObject&quot;</span><span class="p">:</span> <span class="s2">&quot;Q223557&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Sound&quot;</span><span class="p">:</span> <span class="s2">&quot;Q11442&quot;</span><span class="p">,</span>
    <span class="s2">&quot;StillImage&quot;</span><span class="p">:</span> <span class="s2">&quot;Q478798&quot;</span><span class="p">,</span><span class="s2">&quot;http://purl.org/dc/dcmitype/StillImage&quot;</span><span class="p">:</span> <span class="s2">&quot;Q478798&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Text&quot;</span><span class="p">:</span> <span class="s2">&quot;Q1145976&quot;</span><span class="p">,</span><span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;Q1145976&quot;</span>
<span class="p">}</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">typeDict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">gbifRDF</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">GBIFURI</span><span class="p">,</span> <span class="n">WDT</span><span class="o">.</span><span class="n">P31</span><span class="p">,</span> <span class="n">URIRef</span><span class="p">(</span><span class="s2">&quot;http://www.wikidata.org/entity/&quot;</span><span class="o">+</span><span class="n">typeDict</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]])))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">pass</span>
        <span class="c1"># print(f&quot;Error for gbifID={row[&#39;gbifID&#39;]}, type={row[&#39;type&#39;]}&quot;)</span>

    <span class="c1"># language</span>
    <span class="n">langDict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;EN&quot;</span><span class="p">:</span> <span class="s2">&quot;Q1860&quot;</span><span class="p">,</span> <span class="s2">&quot;en&quot;</span><span class="p">:</span> <span class="s2">&quot;Q1860&quot;</span><span class="p">,</span><span class="s2">&quot;En&quot;</span><span class="p">:</span> <span class="s2">&quot;Q1860&quot;</span><span class="p">,</span> <span class="s2">&quot;English&quot;</span><span class="p">:</span> <span class="s2">&quot;Q1860&quot;</span><span class="p">,</span>
        <span class="s2">&quot;PT&quot;</span><span class="p">:</span> <span class="s2">&quot;Q5146&quot;</span><span class="p">,</span><span class="s2">&quot;português&quot;</span><span class="p">:</span> <span class="s2">&quot;Q5146&quot;</span><span class="p">,</span>
        <span class="s2">&quot;es&quot;</span><span class="p">:</span> <span class="s2">&quot;Q1321&quot;</span><span class="p">,</span>
        <span class="s2">&quot;nl&quot;</span><span class="p">:</span> <span class="s2">&quot;Q7411&quot;</span><span class="p">,</span>
        <span class="s2">&quot;fr&quot;</span><span class="p">:</span> <span class="s2">&quot;Q150&quot;</span><span class="p">,</span> <span class="s2">&quot;FR&quot;</span><span class="p">:</span> <span class="s2">&quot;Q150&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Latin&quot;</span><span class="p">:</span> <span class="s2">&quot;Q397&quot;</span><span class="p">,</span> <span class="s2">&quot;la&quot;</span><span class="p">:</span> <span class="s2">&quot;Q397&quot;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;language&quot;</span><span class="p">])</span> <span class="ow">and</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;language&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">langDict</span><span class="p">:</span>
        <span class="n">gbifRDF</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">GBIFURI</span><span class="p">,</span> <span class="n">WDT</span><span class="o">.</span><span class="n">P407</span><span class="p">,</span> <span class="n">URIRef</span><span class="p">(</span><span class="s2">&quot;http://www.wikidata.org/entity/&quot;</span><span class="o">+</span><span class="n">langDict</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;language&quot;</span><span class="p">]])))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">pass</span>
        <span class="c1"># print(f&quot;Error for gbifID={row[&#39;gbifID&#39;]}, language={row[&#39;language&#39;]}&quot;)</span>

    <span class="c1"># IUCN Red List Category</span>
    <span class="n">iucnDict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;NE&quot;</span><span class="p">:</span> <span class="s2">&quot;Q3350324&quot;</span><span class="p">,</span> <span class="s2">&quot;Not Evaluated&quot;</span><span class="p">:</span> <span class="s2">&quot;Q3350324&quot;</span><span class="p">,</span>
        <span class="s2">&quot;LC&quot;</span><span class="p">:</span> <span class="s2">&quot;Q211005&quot;</span><span class="p">,</span> <span class="s2">&quot;Least Concern&quot;</span><span class="p">:</span> <span class="s2">&quot;Q211005&quot;</span><span class="p">,</span>
        <span class="s2">&quot;NT&quot;</span><span class="p">:</span> <span class="s2">&quot;Q719675&quot;</span><span class="p">,</span> <span class="s2">&quot;Near Threatened&quot;</span><span class="p">:</span> <span class="s2">&quot;Q719675&quot;</span><span class="p">,</span>
        <span class="s2">&quot;VU&quot;</span><span class="p">:</span> <span class="s2">&quot;Q278113&quot;</span><span class="p">,</span> <span class="s2">&quot;Vulnerable&quot;</span><span class="p">:</span> <span class="s2">&quot;Q278113&quot;</span><span class="p">,</span>
        <span class="s2">&quot;EN&quot;</span><span class="p">:</span> <span class="s2">&quot;Q11394&quot;</span><span class="p">,</span> <span class="s2">&quot;Endangered&quot;</span><span class="p">:</span> <span class="s2">&quot;Q11394&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CR&quot;</span><span class="p">:</span> <span class="s2">&quot;Q219127&quot;</span><span class="p">,</span> <span class="s2">&quot;Critically Endangered&quot;</span><span class="p">:</span> <span class="s2">&quot;Q219127&quot;</span><span class="p">,</span>
        <span class="s2">&quot;EW&quot;</span><span class="p">:</span> <span class="s2">&quot;Q239509&quot;</span><span class="p">,</span> <span class="s2">&quot;Extinct in the Wild&quot;</span><span class="p">:</span> <span class="s2">&quot;Q239509&quot;</span><span class="p">,</span>
        <span class="s2">&quot;EX&quot;</span><span class="p">:</span> <span class="s2">&quot;Q237350&quot;</span><span class="p">,</span> <span class="s2">&quot;Extinct&quot;</span><span class="p">:</span> <span class="s2">&quot;Q237350&quot;</span><span class="p">,</span>
        <span class="s2">&quot;DD&quot;</span><span class="p">:</span> <span class="s2">&quot;Q3245245&quot;</span><span class="p">,</span> <span class="s2">&quot;Data Deficient&quot;</span><span class="p">:</span> <span class="s2">&quot;Q3245245&quot;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">notna</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;iucnRedListCategory&quot;</span><span class="p">])</span> <span class="ow">and</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;iucnRedListCategory&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">iucnDict</span><span class="p">:</span>
        <span class="n">gbifRDF</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">GBIFURI</span><span class="p">,</span> <span class="n">WDT</span><span class="o">.</span><span class="n">P141</span><span class="p">,</span> <span class="n">URIRef</span><span class="p">(</span><span class="s2">&quot;http://www.wikidata.org/entity/&quot;</span><span class="o">+</span><span class="n">iucnDict</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;iucnRedListCategory&quot;</span><span class="p">]])))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">pass</span>
        <span class="c1"># print(f&quot;Error for gbifID={row[&#39;gbifID&#39;]}, iucnRedListCategory={row[&#39;iucnRedListCategory&#39;]}&quot;)</span>

    <span class="c1"># taxonank</span>
    <span class="n">taxonrankDict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="s2">&quot;Q37517&quot;</span><span class="p">,</span> <span class="s2">&quot;Class&quot;</span><span class="p">:</span> <span class="s2">&quot;Q37517&quot;</span><span class="p">,</span>
        <span class="s2">&quot;family&quot;</span><span class="p">:</span> <span class="s2">&quot;Q35409&quot;</span><span class="p">,</span> <span class="s2">&quot;Family&quot;</span><span class="p">:</span> <span class="s2">&quot;Q35409&quot;</span><span class="p">,</span>
        <span class="s2">&quot;genus&quot;</span><span class="p">:</span> <span class="s2">&quot;Q34740&quot;</span><span class="p">,</span> <span class="s2">&quot;Genus&quot;</span><span class="p">:</span> <span class="s2">&quot;Q34740&quot;</span><span class="p">,</span>
        <span class="s2">&quot;kingdom&quot;</span><span class="p">:</span> <span class="s2">&quot;Q36732&quot;</span><span class="p">,</span> <span class="s2">&quot;Kingdom&quot;</span><span class="p">:</span> <span class="s2">&quot;Q36732&quot;</span><span class="p">,</span>
        <span class="s2">&quot;order&quot;</span><span class="p">:</span> <span class="s2">&quot;Q36602&quot;</span><span class="p">,</span> <span class="s2">&quot;Order&quot;</span><span class="p">:</span> <span class="s2">&quot;Q36602&quot;</span><span class="p">,</span>
        <span class="s2">&quot;phylum&quot;</span><span class="p">:</span> <span class="s2">&quot;Q38348&quot;</span><span class="p">,</span> <span class="s2">&quot;Phylum&quot;</span><span class="p">:</span> <span class="s2">&quot;Q38348&quot;</span><span class="p">,</span>
        <span class="s2">&quot;species&quot;</span><span class="p">:</span> <span class="s2">&quot;Q7432&quot;</span><span class="p">,</span> <span class="s2">&quot;Species&quot;</span><span class="p">:</span> <span class="s2">&quot;Q7432&quot;</span><span class="p">,</span>
        <span class="s2">&quot;subspecies&quot;</span><span class="p">:</span> <span class="s2">&quot;Q68947&quot;</span><span class="p">,</span> <span class="s2">&quot;Subspecies&quot;</span><span class="p">:</span> <span class="s2">&quot;Q68947&quot;</span><span class="p">,</span>
        <span class="s2">&quot;variety&quot;</span><span class="p">:</span> <span class="s2">&quot;Q767728&quot;</span><span class="p">,</span> <span class="s2">&quot;Variety&quot;</span><span class="p">:</span> <span class="s2">&quot;Q767728&quot;</span><span class="p">,</span>
        <span class="s2">&quot;form&quot;</span><span class="p">:</span> <span class="s2">&quot;Q279749&quot;</span><span class="p">,</span> <span class="s2">&quot;Form&quot;</span><span class="p">:</span> <span class="s2">&quot;Q279749&quot;</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;taxonRank&quot;</span><span class="p">])</span> <span class="ow">and</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;taxonRank&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">taxonrankDict</span><span class="p">:</span>
        <span class="n">gbifRDF</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">GBIFURI</span><span class="p">,</span> <span class="n">WDT</span><span class="o">.</span><span class="n">P105</span><span class="p">,</span> <span class="n">URIRef</span><span class="p">(</span><span class="s2">&quot;http://www.wikidata.org/entity/&quot;</span><span class="o">+</span><span class="n">taxonrankDict</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;taxonRank&quot;</span><span class="p">]])))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">pass</span>
        <span class="c1"># print(f&quot;Error for gbifID={row[&#39;gbifID&#39;]}, taxonRank={row[&#39;taxonRank&#39;]}&quot;)</span>
    <span class="c1"># license</span>
    <span class="n">licenseDict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;CC_BY_NC_ND_2_5&quot;</span><span class="p">:</span> <span class="s2">&quot;Q19113746&quot;</span><span class="p">,</span> <span class="s2">&quot;http://creativecommons.org/licenses/by-nc-nd/2.5/&quot;</span><span class="p">:</span> <span class="s2">&quot;Q19113746&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CC_BY_NC_ND_4_0&quot;</span><span class="p">:</span> <span class="s2">&quot;Q24082749&quot;</span><span class="p">,</span> <span class="s2">&quot;http://creativecommons.org/licenses/by-nc-nd/4.0/&quot;</span><span class="p">:</span> <span class="s2">&quot;Q24082749&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CC_BY_NC_SA_2_5&quot;</span><span class="p">:</span> <span class="s2">&quot;Q19068212&quot;</span><span class="p">,</span> <span class="s2">&quot;http://creativecommons.org/licenses/by-nc-sa/2.5/&quot;</span><span class="p">:</span> <span class="s2">&quot;Q19068212&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CC_BY_NC_SA_3_0&quot;</span><span class="p">:</span> <span class="s2">&quot;Q15643954&quot;</span><span class="p">,</span> <span class="s2">&quot;http://creativecommons.org/licenses/by-nc-sa/3.0/&quot;</span><span class="p">:</span> <span class="s2">&quot;Q15643954&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CC_BY_NC_SA_4_0&quot;</span><span class="p">:</span> <span class="s2">&quot;Q42553662&quot;</span><span class="p">,</span> <span class="s2">&quot;http://creativecommons.org/licenses/by-nc-sa/4.0/&quot;</span><span class="p">:</span> <span class="s2">&quot;Q42553662&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CC_BY_NC_4_0&quot;</span><span class="p">:</span> <span class="s2">&quot;Q24082749&quot;</span><span class="p">,</span> <span class="s2">&quot;http://creativecommons.org/licenses/by-nc/4.0/&quot;</span><span class="p">:</span> <span class="s2">&quot;Q24082749&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CC_BY_NC_3_0&quot;</span><span class="p">:</span> <span class="s2">&quot;Q18810331&quot;</span><span class="p">,</span> <span class="s2">&quot;http://creativecommons.org/licenses/by-nc/3.0/&quot;</span><span class="p">:</span> <span class="s2">&quot;Q18810331&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CC_BY_ND_2_5&quot;</span><span class="p">:</span> <span class="s2">&quot;Q18810338&quot;</span><span class="p">,</span> <span class="s2">&quot;http://creativecommons.org/licenses/by-nd/2.5/&quot;</span><span class="p">:</span> <span class="s2">&quot;Q18810338&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CC_BY_ND_3_0&quot;</span><span class="p">:</span> <span class="s2">&quot;Q18810160&quot;</span><span class="p">,</span> <span class="s2">&quot;http://creativecommons.org/licenses/by-nd/3.0/&quot;</span><span class="p">:</span> <span class="s2">&quot;Q18810160&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CC_BY_ND_4_0&quot;</span><span class="p">:</span> <span class="s2">&quot;Q36795408&quot;</span><span class="p">,</span> <span class="s2">&quot;http://creativecommons.org/licenses/by-nd/4.0/&quot;</span><span class="p">:</span> <span class="s2">&quot;Q36795408&quot;</span><span class="p">,</span>
         <span class="s2">&quot;CC_BY_SA_3_0&quot;</span><span class="p">:</span> <span class="s2">&quot;Q14946043&quot;</span><span class="p">,</span><span class="s2">&quot;http://creativecommons.org/licenses/by-sa/3.0/&quot;</span><span class="p">:</span> <span class="s2">&quot;Q14946043&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CC_BY_SA_4_0&quot;</span><span class="p">:</span> <span class="s2">&quot;Q18199165&quot;</span><span class="p">,</span> <span class="s2">&quot;http://creativecommons.org/licenses/by-sa/4.0/&quot;</span><span class="p">:</span> <span class="s2">&quot;Q18199165&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CC_BY_4_0&quot;</span><span class="p">:</span> <span class="s2">&quot;Q18199165&quot;</span><span class="p">,</span> <span class="s2">&quot;http://creativecommons.org/licenses/by/4.0/&quot;</span><span class="p">:</span> <span class="s2">&quot;Q18199165&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CC_BY_3_0&quot;</span><span class="p">:</span> <span class="s2">&quot;Q14947546&quot;</span><span class="p">,</span> <span class="s2">&quot;http://creativecommons.org/licenses/by/3.0/&quot;</span><span class="p">:</span> <span class="s2">&quot;Q14947546&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CC0_1_0&quot;</span><span class="p">:</span> <span class="s2">&quot;Q18199165&quot;</span><span class="p">,</span> <span class="s2">&quot;http://creativecommons.org/publicdomain/zero/1.0/&quot;</span><span class="p">:</span> <span class="s2">&quot;Q18199165&quot;</span><span class="p">,</span>
        <span class="s2">&quot;https://huh.harvard.edu/access-digital-reproductions-works-public-domain&quot;</span><span class="p">:</span><span class="s2">&quot;Q18199165&quot;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;license&quot;</span><span class="p">])</span> <span class="ow">and</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;license&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">licenseDict</span><span class="p">:</span>
        <span class="n">gbifRDF</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">GBIFURI</span><span class="p">,</span> <span class="n">WDT</span><span class="o">.</span><span class="n">P275</span><span class="p">,</span> <span class="n">URIRef</span><span class="p">(</span><span class="s2">&quot;http://www.wikidata.org/entity/&quot;</span><span class="o">+</span><span class="n">licenseDict</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;license&quot;</span><span class="p">]])))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">pass</span>
        <span class="c1"># print(f&quot;Error for gbifID={row[&#39;gbifID&#39;]}, license={row[&#39;license&#39;]}&quot;)</span>

    <span class="c1"># sex</span>
    <span class="n">sexDict</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;FEMALE&quot;</span><span class="p">:</span> <span class="s2">&quot;Q43445&quot;</span><span class="p">,</span>
        <span class="s2">&quot;MALE&quot;</span><span class="p">:</span> <span class="s2">&quot;Q44148&quot;</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;sex&quot;</span><span class="p">])</span> <span class="ow">and</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;sex&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">sexDict</span><span class="p">:</span>
        <span class="n">gbifRDF</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">GBIFURI</span><span class="p">,</span> <span class="n">WDT</span><span class="o">.</span><span class="n">P21</span><span class="p">,</span> <span class="n">URIRef</span><span class="p">(</span><span class="s2">&quot;http://www.wikidata.org/entity/&quot;</span><span class="o">+</span><span class="n">sexDict</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;sex&quot;</span><span class="p">]])))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="c1"># recordedByID</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;recordedByID&quot;</span><span class="p">]):</span>
        <span class="n">gbifRDF</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">GBIFURI</span><span class="p">,</span> <span class="n">WDT</span><span class="o">.</span><span class="n">P170</span><span class="p">,</span> <span class="n">Literal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;recordedByID&quot;</span><span class="p">]),</span> <span class="n">datatype</span><span class="o">=</span><span class="n">XSD</span><span class="o">.</span><span class="n">string</span><span class="p">)))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="c1"># associatedSequences</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;associatedSequences&quot;</span><span class="p">]):</span>
        <span class="n">gbifRDF</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">GBIFURI</span><span class="p">,</span> <span class="n">WDT</span><span class="o">.</span><span class="n">P4333</span><span class="p">,</span> <span class="n">Literal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;associatedSequences&quot;</span><span class="p">]),</span> <span class="n">datatype</span><span class="o">=</span><span class="n">XSD</span><span class="o">.</span><span class="n">string</span><span class="p">)))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="c1"># occurrenceID</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;occurrenceID&quot;</span><span class="p">]):</span>
        <span class="n">gbifRDF</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">GBIFURI</span><span class="p">,</span> <span class="n">DC</span><span class="o">.</span><span class="n">identifier</span><span class="p">,</span> <span class="n">Literal</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;occurrenceID&quot;</span><span class="p">]),</span> <span class="n">datatype</span><span class="o">=</span><span class="n">XSD</span><span class="o">.</span><span class="n">string</span><span class="p">)))</span>

    <span class="c1"># publisher</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;rightsHolder&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">instituteQID</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">gbifRDF</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">GBIFURI</span><span class="p">,</span> <span class="n">WDT</span><span class="o">.</span><span class="n">P123</span><span class="p">,</span> <span class="n">URIRef</span><span class="p">(</span><span class="s2">&quot;http://www.wikidata.org/entity/&quot;</span><span class="o">+</span><span class="n">instituteQID</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;rightsHolder&quot;</span><span class="p">]])))</span>
        <span class="n">gbifRDF</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">URIRef</span><span class="p">(</span><span class="s2">&quot;http://www.wikidata.org/entity/&quot;</span><span class="o">+</span><span class="n">instituteQID</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;rightsHolder&quot;</span><span class="p">]]),</span> <span class="n">RDFS</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="n">Literal</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;rightsHolder&quot;</span><span class="p">],</span> <span class="n">lang</span><span class="o">=</span><span class="s2">&quot;en&quot;</span><span class="p">)))</span>

    <span class="c1"># kingfom</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;kingdom_y&quot;</span><span class="p">]):</span>
        <span class="n">gbifRDF</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">GBIFURI</span><span class="p">,</span> <span class="n">WDT</span><span class="o">.</span><span class="n">P910</span><span class="p">,</span> <span class="n">URIRef</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;kingdom_y&quot;</span><span class="p">])))</span> <span class="c1">#chapter</span>
        <span class="n">gbifRDF</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">URIRef</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;kingdom_y&quot;</span><span class="p">]),</span> <span class="n">RDFS</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="n">Literal</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;kingdomname&quot;</span><span class="p">],</span> <span class="n">lang</span><span class="o">=</span><span class="s2">&quot;en&quot;</span><span class="p">)))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="c1">#Wiki article</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;article&quot;</span><span class="p">]):</span>
        <span class="n">gbifRDF</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">GBIFURI</span><span class="p">,</span> <span class="n">DC</span><span class="o">.</span><span class="n">description</span><span class="p">,</span> <span class="n">URIRef</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;article&quot;</span><span class="p">])))</span> <span class="c1">#chapter</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>87it [00:00, 2816.79it/s]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_image</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/0002020-240626123714530/multimedia.txt&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">on_bad_lines</span> <span class="o">=</span> <span class="s1">&#39;warn&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df_image</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">GBIFURI</span> <span class="o">=</span> <span class="n">URIRef</span><span class="p">(</span><span class="s2">&quot;https://gbif.semscape.org/occurrence/&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;gbifID&quot;</span><span class="p">]))</span>
    <span class="n">mediaURI</span> <span class="o">=</span> <span class="n">BNode</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;StillImage&quot;</span><span class="p">:</span>
        <span class="n">gbifRDF</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">mediaURI</span><span class="p">,</span> <span class="n">WDT</span><span class="o">.</span><span class="n">P31</span><span class="p">,</span> <span class="n">WD</span><span class="o">.</span><span class="n">Q17538176</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Sound&quot;</span><span class="p">:</span>
        <span class="n">gbifRDF</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">mediaURI</span><span class="p">,</span> <span class="n">WDT</span><span class="o">.</span><span class="n">P31</span><span class="p">,</span> <span class="n">WD</span><span class="o">.</span><span class="n">Q11461</span><span class="p">))</span>
    <span class="n">gbifRDF</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">mediaURI</span><span class="p">,</span> <span class="n">DCTERMS</span><span class="o">.</span><span class="n">format</span><span class="p">,</span> <span class="n">Literal</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;format&quot;</span><span class="p">],</span> <span class="n">datatype</span><span class="o">=</span><span class="n">XSD</span><span class="o">.</span><span class="n">string</span><span class="p">)))</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;license&quot;</span><span class="p">])</span> <span class="ow">and</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;license&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">licenseDict</span><span class="p">:</span>
        <span class="n">gbifRDF</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">mediaURI</span><span class="p">,</span> <span class="n">WDT</span><span class="o">.</span><span class="n">P275</span><span class="p">,</span> <span class="n">URIRef</span><span class="p">(</span><span class="s2">&quot;http://www.wikidata.org/entity/&quot;</span><span class="o">+</span><span class="n">licenseDict</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;license&quot;</span><span class="p">]])))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="n">gbifRDF</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">mediaURI</span><span class="p">,</span> <span class="n">WDT</span><span class="o">.</span><span class="n">P2699</span><span class="p">,</span> <span class="n">Literal</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;identifier&quot;</span><span class="p">],</span> <span class="n">datatype</span><span class="o">=</span><span class="n">XSD</span><span class="o">.</span><span class="n">string</span><span class="p">)))</span>
    <span class="n">gbifRDF</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">mediaURI</span><span class="p">,</span> <span class="n">WDT</span><span class="o">.</span><span class="n">P361</span><span class="p">,</span> <span class="n">GBIFURI</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wdtaxqid</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;5289739&#39;: &#39;http://www.wikidata.org/entity/Q4925284&#39;,
 &#39;2704745&#39;: &#39;http://www.wikidata.org/entity/Q7579252&#39;,
 &#39;2717421&#39;: &#39;http://www.wikidata.org/entity/Q15584858&#39;,
 &#39;2702504&#39;: &#39;http://www.wikidata.org/entity/Q24700355&#39;,
 &#39;2705068&#39;: &#39;http://www.wikidata.org/entity/Q10912779&#39;,
 &#39;2708680&#39;: &#39;http://www.wikidata.org/entity/Q11075670&#39;,
 &#39;2702854&#39;: &#39;http://www.wikidata.org/entity/Q15508551&#39;,
 &#39;2702852&#39;: &#39;http://www.wikidata.org/entity/Q15508581&#39;,
 &#39;2702522&#39;: &#39;http://www.wikidata.org/entity/Q15516186&#39;,
 &#39;5291147&#39;: &#39;http://www.wikidata.org/entity/Q15550242&#39;,
 &#39;2705275&#39;: &#39;http://www.wikidata.org/entity/Q33913&#39;,
 &#39;2705758&#39;: &#39;http://www.wikidata.org/entity/Q3219428&#39;,
 &#39;2705656&#39;: &#39;http://www.wikidata.org/entity/Q3367780&#39;,
 &#39;2706277&#39;: &#39;http://www.wikidata.org/entity/Q4790962&#39;,
 &#39;2706079&#39;: &#39;http://www.wikidata.org/entity/Q15504478&#39;,
 &#39;2720622&#39;: &#39;http://www.wikidata.org/entity/Q15557622&#39;,
 &#39;2712691&#39;: &#39;http://www.wikidata.org/entity/Q15564658&#39;,
 &#39;2718767&#39;: &#39;http://www.wikidata.org/entity/Q21265100&#39;,
 &#39;2702936&#39;: &#39;http://www.wikidata.org/entity/Q15504902&#39;,
 &#39;2715182&#39;: &#39;http://www.wikidata.org/entity/Q15535602&#39;,
 &#39;5289968&#39;: &#39;http://www.wikidata.org/entity/Q11066188&#39;,
 &#39;2705583&#39;: &#39;http://www.wikidata.org/entity/Q15246196&#39;,
 &#39;2705827&#39;: &#39;http://www.wikidata.org/entity/Q15509620&#39;,
 &#39;2721307&#39;: &#39;http://www.wikidata.org/entity/Q15555289&#39;,
 &#39;2706301&#39;: &#39;http://www.wikidata.org/entity/Q827098&#39;,
 &#39;2705924&#39;: &#39;http://www.wikidata.org/entity/Q4830676&#39;,
 &#39;2715045&#39;: &#39;http://www.wikidata.org/entity/Q6539452&#39;,
 &#39;5289938&#39;: &#39;http://www.wikidata.org/entity/Q14834635&#39;}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the URI prefix you are interested in</span>
<span class="n">prefix</span> <span class="o">=</span> <span class="s2">&quot;http://www.wikidata.org/entity/&quot;</span>

<span class="c1"># Initialize a set to hold all matching URIs</span>
<span class="n">wikidata_uris</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

<span class="c1"># Iterate through all nodes in the graph, both subjects and objects</span>
<span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">gbifRDF</span><span class="o">.</span><span class="n">all_nodes</span><span class="p">():</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">URIRef</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">str</span><span class="p">(</span><span class="n">node</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">prefix</span><span class="p">):</span>
        <span class="n">wikidata_uris</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">node</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gbifRDF</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">destination</span><span class="o">=</span><span class="s1">&#39;gbifMontserrat.ttl&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;turtle&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Graph identifier=N8d51f83dcba44792aa44d81c4e121930 (&lt;class &#39;rdflib.graph.Graph&#39;&gt;)&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wdGraph</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">()</span>

<span class="c1"># Wrapping wikidata_uris with tqdm to create a progress bar</span>
<span class="k">for</span> <span class="n">wduri</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span><span class="n">wikidata_uris</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;Processing URIs&quot;</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">wduri</span><span class="p">))</span>
        <span class="n">wdGraph</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">wduri</span><span class="p">),</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;turtle&#39;</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>  <span class="c1"># It&#39;s a good practice to log the exception</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;An error occurred while parsing </span><span class="si">{</span><span class="n">wduri</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">continue</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing URIs:   0%|          | 0/41 [00:00&lt;?, ?it/s]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>http://www.wikidata.org/entity/Q24700355
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing URIs:   2%|▏         | 1/41 [00:02&lt;01:55,  2.89s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>http://www.wikidata.org/entity/Q15584858
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing URIs:   5%|▍         | 2/41 [00:04&lt;01:25,  2.19s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>http://www.wikidata.org/entity/Q21265100
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing URIs:   7%|▋         | 3/41 [00:08&lt;01:47,  2.82s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>http://www.wikidata.org/entity/Q15535602
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing URIs:  10%|▉         | 4/41 [00:11&lt;01:44,  2.83s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>http://www.wikidata.org/entity/Q4830676
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing URIs:  12%|█▏        | 5/41 [00:13&lt;01:31,  2.54s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>http://www.wikidata.org/entity/Q10912779
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing URIs:  15%|█▍        | 6/41 [00:14&lt;01:19,  2.27s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>http://www.wikidata.org/entity/Q15564658
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing URIs:  17%|█▋        | 7/41 [00:16&lt;01:05,  1.93s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>http://www.wikidata.org/entity/Q33913
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing URIs:  20%|█▉        | 8/41 [00:18&lt;01:06,  2.00s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>http://www.wikidata.org/entity/Q14834635
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing URIs:  22%|██▏       | 9/41 [00:20&lt;01:08,  2.15s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>http://www.wikidata.org/entity/Q15509620
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing URIs:  24%|██▍       | 10/41 [00:22&lt;01:03,  2.04s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>http://www.wikidata.org/entity/Q163571
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing URIs:  27%|██▋       | 11/41 [00:24&lt;00:56,  1.90s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>http://www.wikidata.org/entity/Q756
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Failed to convert Literal lexical form to value. Datatype=http://www.w3.org/2001/XMLSchema#dateTime, Converter=&lt;function parse_datetime at 0x120156ac0&gt;
Traceback (most recent call last):
  File &quot;/Users/andra/projects/Grasses-and-sedges-of-Montserrat/GrassesMontserrat/.venv/lib/python3.12/site-packages/rdflib/term.py&quot;, line 2119, in _castLexicalToPython
    return conv_func(lexical)  # type: ignore[arg-type]
           ^^^^^^^^^^^^^^^^^^
  File &quot;/Users/andra/projects/Grasses-and-sedges-of-Montserrat/GrassesMontserrat/.venv/lib/python3.12/site-packages/isodate/isodatetime.py&quot;, line 55, in parse_datetime
    tmpdate = parse_date(datestring)
              ^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/Users/andra/projects/Grasses-and-sedges-of-Montserrat/GrassesMontserrat/.venv/lib/python3.12/site-packages/isodate/isodates.py&quot;, line 203, in parse_date
    raise ISO8601Error(&#39;Unrecognised ISO 8601 date format: %r&#39; % datestring)
isodate.isoerror.ISO8601Error: Unrecognised ISO 8601 date format: &#39;-1200000000-01-01&#39;
Failed to convert Literal lexical form to value. Datatype=http://www.w3.org/2001/XMLSchema#dateTime, Converter=&lt;function parse_datetime at 0x120156ac0&gt;
Traceback (most recent call last):
  File &quot;/Users/andra/projects/Grasses-and-sedges-of-Montserrat/GrassesMontserrat/.venv/lib/python3.12/site-packages/rdflib/term.py&quot;, line 2119, in _castLexicalToPython
    return conv_func(lexical)  # type: ignore[arg-type]
           ^^^^^^^^^^^^^^^^^^
  File &quot;/Users/andra/projects/Grasses-and-sedges-of-Montserrat/GrassesMontserrat/.venv/lib/python3.12/site-packages/isodate/isodatetime.py&quot;, line 55, in parse_datetime
    tmpdate = parse_date(datestring)
              ^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/Users/andra/projects/Grasses-and-sedges-of-Montserrat/GrassesMontserrat/.venv/lib/python3.12/site-packages/isodate/isodates.py&quot;, line 203, in parse_date
    raise ISO8601Error(&#39;Unrecognised ISO 8601 date format: %r&#39; % datestring)
isodate.isoerror.ISO8601Error: Unrecognised ISO 8601 date format: &#39;-460000000-01-01&#39;
Failed to convert Literal lexical form to value. Datatype=http://www.w3.org/2001/XMLSchema#dateTime, Converter=&lt;function parse_datetime at 0x120156ac0&gt;
Traceback (most recent call last):
  File &quot;/Users/andra/projects/Grasses-and-sedges-of-Montserrat/GrassesMontserrat/.venv/lib/python3.12/site-packages/rdflib/term.py&quot;, line 2119, in _castLexicalToPython
    return conv_func(lexical)  # type: ignore[arg-type]
           ^^^^^^^^^^^^^^^^^^
  File &quot;/Users/andra/projects/Grasses-and-sedges-of-Montserrat/GrassesMontserrat/.venv/lib/python3.12/site-packages/isodate/isodatetime.py&quot;, line 55, in parse_datetime
    tmpdate = parse_date(datestring)
              ^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/Users/andra/projects/Grasses-and-sedges-of-Montserrat/GrassesMontserrat/.venv/lib/python3.12/site-packages/isodate/isodates.py&quot;, line 203, in parse_date
    raise ISO8601Error(&#39;Unrecognised ISO 8601 date format: %r&#39; % datestring)
isodate.isoerror.ISO8601Error: Unrecognised ISO 8601 date format: &#39;-1200000000-01-01&#39;
Failed to convert Literal lexical form to value. Datatype=http://www.w3.org/2001/XMLSchema#dateTime, Converter=&lt;function parse_datetime at 0x120156ac0&gt;
Traceback (most recent call last):
  File &quot;/Users/andra/projects/Grasses-and-sedges-of-Montserrat/GrassesMontserrat/.venv/lib/python3.12/site-packages/rdflib/term.py&quot;, line 2119, in _castLexicalToPython
    return conv_func(lexical)  # type: ignore[arg-type]
           ^^^^^^^^^^^^^^^^^^
  File &quot;/Users/andra/projects/Grasses-and-sedges-of-Montserrat/GrassesMontserrat/.venv/lib/python3.12/site-packages/isodate/isodatetime.py&quot;, line 55, in parse_datetime
    tmpdate = parse_date(datestring)
              ^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/Users/andra/projects/Grasses-and-sedges-of-Montserrat/GrassesMontserrat/.venv/lib/python3.12/site-packages/isodate/isodates.py&quot;, line 203, in parse_date
    raise ISO8601Error(&#39;Unrecognised ISO 8601 date format: %r&#39; % datestring)
isodate.isoerror.ISO8601Error: Unrecognised ISO 8601 date format: &#39;-460000000-01-01&#39;
Failed to convert Literal lexical form to value. Datatype=http://www.w3.org/2001/XMLSchema#dateTime, Converter=&lt;function parse_datetime at 0x120156ac0&gt;
Traceback (most recent call last):
  File &quot;/Users/andra/projects/Grasses-and-sedges-of-Montserrat/GrassesMontserrat/.venv/lib/python3.12/site-packages/rdflib/term.py&quot;, line 2119, in _castLexicalToPython
    return conv_func(lexical)  # type: ignore[arg-type]
           ^^^^^^^^^^^^^^^^^^
  File &quot;/Users/andra/projects/Grasses-and-sedges-of-Montserrat/GrassesMontserrat/.venv/lib/python3.12/site-packages/isodate/isodatetime.py&quot;, line 55, in parse_datetime
    tmpdate = parse_date(datestring)
              ^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/Users/andra/projects/Grasses-and-sedges-of-Montserrat/GrassesMontserrat/.venv/lib/python3.12/site-packages/isodate/isodates.py&quot;, line 203, in parse_date
    raise ISO8601Error(&#39;Unrecognised ISO 8601 date format: %r&#39; % datestring)
isodate.isoerror.ISO8601Error: Unrecognised ISO 8601 date format: &#39;-1200000000-01-01&#39;
Failed to convert Literal lexical form to value. Datatype=http://www.w3.org/2001/XMLSchema#dateTime, Converter=&lt;function parse_datetime at 0x120156ac0&gt;
Traceback (most recent call last):
  File &quot;/Users/andra/projects/Grasses-and-sedges-of-Montserrat/GrassesMontserrat/.venv/lib/python3.12/site-packages/rdflib/term.py&quot;, line 2119, in _castLexicalToPython
    return conv_func(lexical)  # type: ignore[arg-type]
           ^^^^^^^^^^^^^^^^^^
  File &quot;/Users/andra/projects/Grasses-and-sedges-of-Montserrat/GrassesMontserrat/.venv/lib/python3.12/site-packages/isodate/isodatetime.py&quot;, line 55, in parse_datetime
    tmpdate = parse_date(datestring)
              ^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/Users/andra/projects/Grasses-and-sedges-of-Montserrat/GrassesMontserrat/.venv/lib/python3.12/site-packages/isodate/isodates.py&quot;, line 203, in parse_date
    raise ISO8601Error(&#39;Unrecognised ISO 8601 date format: %r&#39; % datestring)
isodate.isoerror.ISO8601Error: Unrecognised ISO 8601 date format: &#39;-460000000-01-01&#39;
Processing URIs:  29%|██▉       | 12/41 [00:30&lt;01:37,  3.36s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>http://www.wikidata.org/entity/Q15504902
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing URIs:  32%|███▏      | 13/41 [00:32&lt;01:18,  2.82s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>http://www.wikidata.org/entity/Q3367780
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing URIs:  34%|███▍      | 14/41 [00:35&lt;01:17,  2.87s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>http://www.wikidata.org/entity/Q827098
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing URIs:  37%|███▋      | 15/41 [00:38&lt;01:19,  3.04s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>http://www.wikidata.org/entity/Q36495
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing URIs:  39%|███▉      | 16/41 [00:41&lt;01:17,  3.08s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>http://www.wikidata.org/entity/Q3052500
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing URIs:  41%|████▏     | 17/41 [00:45&lt;01:17,  3.23s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>http://www.wikidata.org/entity/Q56880932
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing URIs:  44%|████▍     | 18/41 [00:46&lt;01:00,  2.62s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>http://www.wikidata.org/entity/Q15557622
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing URIs:  46%|████▋     | 19/41 [00:48&lt;00:51,  2.35s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>http://www.wikidata.org/entity/Q15246196
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing URIs:  49%|████▉     | 20/41 [00:50&lt;00:45,  2.15s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>http://www.wikidata.org/entity/Q15555289
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing URIs:  51%|█████     | 21/41 [00:51&lt;00:41,  2.08s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>http://www.wikidata.org/entity/Q15508551
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing URIs:  54%|█████▎    | 22/41 [00:53&lt;00:38,  2.03s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>http://www.wikidata.org/entity/Q15550242
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing URIs:  56%|█████▌    | 23/41 [00:55&lt;00:31,  1.78s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>http://www.wikidata.org/entity/Q15508581
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing URIs:  59%|█████▊    | 24/41 [00:56&lt;00:29,  1.75s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>http://www.wikidata.org/entity/Q28913658
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing URIs:  61%|██████    | 25/41 [00:59&lt;00:32,  2.01s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>http://www.wikidata.org/entity/Q1043983
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing URIs:  63%|██████▎   | 26/41 [01:01&lt;00:28,  1.91s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>http://www.wikidata.org/entity/Q4790962
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing URIs:  66%|██████▌   | 27/41 [01:02&lt;00:26,  1.90s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>http://www.wikidata.org/entity/Q17538176
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing URIs:  68%|██████▊   | 28/41 [01:03&lt;00:20,  1.59s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>http://www.wikidata.org/entity/Q6539452
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing URIs:  71%|███████   | 29/41 [01:05&lt;00:21,  1.75s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>http://www.wikidata.org/entity/Q11066188
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing URIs:  73%|███████▎  | 30/41 [01:08&lt;00:20,  1.87s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>http://www.wikidata.org/entity/Q1860
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing URIs:  76%|███████▌  | 31/41 [01:20&lt;00:50,  5.06s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>http://www.wikidata.org/entity/Q4925284
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing URIs:  78%|███████▊  | 32/41 [01:23&lt;00:38,  4.31s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>http://www.wikidata.org/entity/Q18199165
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing URIs:  80%|████████  | 33/41 [01:24&lt;00:28,  3.50s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>http://www.wikidata.org/entity/Q11075670
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing URIs:  83%|████████▎ | 34/41 [01:26&lt;00:20,  2.97s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>http://www.wikidata.org/entity/Q24082749
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing URIs:  85%|████████▌ | 35/41 [01:27&lt;00:14,  2.38s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>http://www.wikidata.org/entity/Q501758
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing URIs:  88%|████████▊ | 36/41 [01:32&lt;00:15,  3.15s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>http://www.wikidata.org/entity/Q636275
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing URIs:  90%|█████████ | 37/41 [01:36&lt;00:13,  3.34s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>http://www.wikidata.org/entity/Q7579252
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing URIs:  93%|█████████▎| 38/41 [01:38&lt;00:09,  3.05s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>http://www.wikidata.org/entity/Q223557
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing URIs:  95%|█████████▌| 39/41 [01:40&lt;00:05,  2.60s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>http://www.wikidata.org/entity/Q15516186
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing URIs:  98%|█████████▊| 40/41 [01:41&lt;00:02,  2.36s/it]
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>http://www.wikidata.org/entity/Q15504478
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Processing URIs: 100%|██████████| 41/41 [01:43&lt;00:00,  2.52s/it]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">wdGraph</span><span class="o">.</span><span class="n">serialize</span><span class="p">(</span><span class="n">destination</span><span class="o">=</span><span class="s1">&#39;wikidataMontserrat.ttl&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;turtle&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Graph identifier=N3cc229e57417463bb9c56ae2f21f9143 (&lt;class &#39;rdflib.graph.Graph&#39;&gt;)&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">PREFIX wd: &lt;http://www.wikidata.org/entity/&gt;</span>
<span class="s2">    PREFIX wdt: &lt;http://www.wikidata.org/prop/direct/&gt;</span>
<span class="s2">    SELECT DISTINCT  ?taxon ?taxonLabel ?publisher ?publisherLabel ?observation ?gbifObservation ?media ?media_url ?license WHERE {</span>
<span class="s2">           ?media wdt:P2699 ?media_url ;</span>
<span class="s2">                  wdt:P275 ?license ;</span>
<span class="s2">                  wdt:P361 ?observation .</span>
<span class="s2">          ?observation wdt:P225 ?taxon ;</span>
<span class="s2">                       wdt:P854 ?gbifObservation ;</span>
<span class="s2">                       wdt:P123 ?publisher .</span>
<span class="s2">          ?taxon rdfs:label ?taxonLabel .</span>
<span class="s2">          OPTIONAL {?taxon dc:description ?article .}</span>
<span class="s2">          ?publisher rdfs:label ?publisherLabel .</span>
<span class="s2">            }&quot;&quot;&quot;</span>
<span class="c1"># Assuming gbifRDF.query(query) has been defined and executed</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">gbifRDF</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
<span class="n">taxonpages</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># Ensure that taxonpages is defined before the loop</span>

<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
    <span class="c1"># Cache commonly used row items to avoid repetitive dictionary lookups and conversions</span>
    <span class="n">taxon_label</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;taxonLabel&quot;</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">taxon_label</span><span class="p">)</span>
    <span class="n">publisher_label</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;publisherLabel&quot;</span><span class="p">])</span>

    <span class="c1"># If the taxon label is not in taxonpages, initialize it with necessary keys</span>
    <span class="k">if</span> <span class="n">taxon_label</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">taxonpages</span><span class="p">:</span>
        <span class="n">taxonpages</span><span class="p">[</span><span class="n">taxon_label</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;wd_uri&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;taxon&quot;</span><span class="p">]),</span>
            <span class="s2">&quot;publisher&quot;</span><span class="p">:</span> <span class="p">{},</span>  <span class="c1"># Initialize the publisher dictionary here</span>
        <span class="p">}</span>
        <span class="c1"># Add the article if it exists in the row</span>
        <span class="k">if</span> <span class="s2">&quot;article&quot;</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
            <span class="n">taxonpages</span><span class="p">[</span><span class="n">taxon_label</span><span class="p">][</span><span class="s2">&quot;article&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;article&quot;</span><span class="p">])</span>

    <span class="c1"># Ensure the publisher label is initialized in the taxon&#39;s publisher dictionary</span>
    <span class="k">if</span> <span class="n">publisher_label</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">taxonpages</span><span class="p">[</span><span class="n">taxon_label</span><span class="p">][</span><span class="s2">&quot;publisher&quot;</span><span class="p">]:</span>
        <span class="n">taxonpages</span><span class="p">[</span><span class="n">taxon_label</span><span class="p">][</span><span class="s2">&quot;publisher&quot;</span><span class="p">][</span><span class="n">publisher_label</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;observations&quot;</span><span class="p">:</span> <span class="p">[]</span>  <span class="c1"># Initialize the observations list here</span>
        <span class="p">}</span>

    <span class="c1"># Construct the observation dictionary</span>
    <span class="n">observation</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;observation_id&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;gbifObservation&quot;</span><span class="p">]),</span>
        <span class="s2">&quot;media&quot;</span><span class="p">:</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;media_url&quot;</span><span class="p">])],</span>  <span class="c1"># Initialize media as a list with the media_url</span>
        <span class="s2">&quot;license&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;license&quot;</span><span class="p">])</span>
    <span class="p">}</span>
    <span class="c1"># Append the observation dictionary to the observations list</span>
    <span class="n">taxonpages</span><span class="p">[</span><span class="n">taxon_label</span><span class="p">][</span><span class="s2">&quot;publisher&quot;</span><span class="p">][</span><span class="n">publisher_label</span><span class="p">][</span><span class="s2">&quot;observations&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">observation</span><span class="p">)</span>

<span class="c1"># The rest of your processing can continue after this</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;rdflib.plugins.sparql.processor.SPARQLResult object at 0x12464e090&gt;
Cyperus brevifolius
Cyperus brevifolius
Rhynchospora nervosa
Rhynchospora nervosa
Rhynchospora nervosa
Rhynchospora nervosa
Lasiacis divaricata
Axonopus compressus
Rhynchospora nervosa
Rhynchospora nervosa
Eleocharis flavescens
Eriochloa punctata
Cymbopogon citratus
Cyperus sphacelatus
Anthephora hermaphrodita
Lasiacis divaricata
Andropogon bicornis
Cenchrus echinatus
Scleria secans
Cyperus alopecuroides
Cyperus sphacelatus
Coix lacryma-jobi
Aristida adscensionis
Panicum trichoides
Paspalum conjugatum
Panicum trichoides
Aristida adscensionis
Digitaria insularis
Eriochloa punctata
Digitaria insularis
Rhynchospora tenerrima
Fimbristylis complanata
Anthephora hermaphrodita
Anthephora hermaphrodita
Anthephora hermaphrodita
Rhynchospora tenerrima
Cyperus alopecuroides
Cenchrus echinatus
Paspalum fimbriatum
Panicum trichoides
Panicum trichoides
Lasiacis divaricata
Lasiacis sorghoidea
Digitaria insularis
Cyperus sphacelatus
Fimbristylis complanata
Aristida adscensionis
Anthephora hermaphrodita
Cyperus alopecuroides
Digitaria bicornis
Andropogon bicornis
Coix lacryma-jobi
Lasiacis sorghoidea
Paspalum conjugatum
Scleria secans
Cyperus sphacelatus
Brachiaria fasciculata
Lasiacis sorghoidea
Machaerina restioides
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">taxonpages</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Cyperus brevifolius&#39;: {&#39;wd_uri&#39;: &#39;http://www.wikidata.org/entity/Q21265100&#39;,
  &#39;publisher&#39;: {&#39;Meise Botanic Garden&#39;: {&#39;observations&#39;: [{&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/4876300936&#39;,
      &#39;media&#39;: [&#39;https://iiif-manifest.oxalis.br.fgov.be/specimen/BR0000027525951V/manifest&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;},
     {&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/4876300936&#39;,
      &#39;media&#39;: [&#39;https://oxalis.br.fgov.be/images/V/BR0/000/027/525/951/BR0000027525951V.jpg&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;}]}}},
 &#39;Rhynchospora nervosa&#39;: {&#39;wd_uri&#39;: &#39;http://www.wikidata.org/entity/Q15555289&#39;,
  &#39;publisher&#39;: {&#39;Meise Botanic Garden&#39;: {&#39;observations&#39;: [{&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/4876284841&#39;,
      &#39;media&#39;: [&#39;https://iiif-manifest.oxalis.br.fgov.be/specimen/BR0000026554150V/manifest&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;},
     {&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/4876284841&#39;,
      &#39;media&#39;: [&#39;https://oxalis.br.fgov.be/images/V/BR0/000/026/554/150/BR0000026554150V.jpg&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;}]},
   &#39;Sofie Meeus&#39;: {&#39;observations&#39;: [{&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/4535850595&#39;,
      &#39;media&#39;: [&#39;https://inaturalist-open-data.s3.amazonaws.com/photos/213079204/original.jpeg&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;},
     {&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/4535850595&#39;,
      &#39;media&#39;: [&#39;https://inaturalist-open-data.s3.amazonaws.com/photos/213079086/original.jpeg&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;},
     {&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/3860636265&#39;,
      &#39;media&#39;: [&#39;https://inaturalist-open-data.s3.amazonaws.com/photos/211400204/original.jpeg&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;},
     {&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/3860636265&#39;,
      &#39;media&#39;: [&#39;https://inaturalist-open-data.s3.amazonaws.com/photos/211400213/original.jpeg&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;}]}}},
 &#39;Lasiacis divaricata&#39;: {&#39;wd_uri&#39;: &#39;http://www.wikidata.org/entity/Q15508581&#39;,
  &#39;publisher&#39;: {&#39;nan&#39;: {&#39;observations&#39;: [{&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/4519387627&#39;,
      &#39;media&#39;: [&#39;https://d2seqvvyy3b8p2.cloudfront.net/0a4517053793e946bdc3cccaccbf3d2b.jpg&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;},
     {&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1321333395&#39;,
      &#39;media&#39;: [&#39;http://n2t.net/ark:/65665/m31c9184db-f3b6-498c-b1fd-6e7356c686fb&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;}]},
   &#39;The New York Botanical Garden&#39;: {&#39;observations&#39;: [{&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1931227653&#39;,
      &#39;media&#39;: [&#39;http://sweetgum.nybg.org/images3/793/048/1603435.jpg&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;}]}}},
 &#39;Axonopus compressus&#39;: {&#39;wd_uri&#39;: &#39;http://www.wikidata.org/entity/Q4830676&#39;,
  &#39;publisher&#39;: {&#39;Quentin Groom&#39;: {&#39;observations&#39;: [{&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/3888808487&#39;,
      &#39;media&#39;: [&#39;https://inaturalist-open-data.s3.amazonaws.com/photos/213025154/original.jpeg&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;}]}}},
 &#39;Eleocharis flavescens&#39;: {&#39;wd_uri&#39;: &#39;http://www.wikidata.org/entity/Q15584858&#39;,
  &#39;publisher&#39;: {&#39;University of Florida&#39;: {&#39;observations&#39;: [{&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/3855443758&#39;,
      &#39;media&#39;: [&#39;https://cdn.floridamuseum.ufl.edu/Herbarium/8fc39afb-b53b-4e89-8df5-96ab519283a5&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q24082749&#39;}]}}},
 &#39;Eriochloa punctata&#39;: {&#39;wd_uri&#39;: &#39;http://www.wikidata.org/entity/Q15516186&#39;,
  &#39;publisher&#39;: {&#39;nan&#39;: {&#39;observations&#39;: [{&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/3005755768&#39;,
      &#39;media&#39;: [&#39;http://n2t.net/ark:/65665/m35f0c1501-c8e8-4ed6-8a7c-0c6ad2db9651&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;}]},
   &#39;The New York Botanical Garden&#39;: {&#39;observations&#39;: [{&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1929001297&#39;,
      &#39;media&#39;: [&#39;http://sweetgum.nybg.org/images3/792/095/1602472.jpg&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;}]}}},
 &#39;Cymbopogon citratus&#39;: {&#39;wd_uri&#39;: &#39;http://www.wikidata.org/entity/Q33913&#39;,
  &#39;publisher&#39;: {&#39;classical&#39;: {&#39;observations&#39;: [{&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/2633970554&#39;,
      &#39;media&#39;: [&#39;https://inaturalist-open-data.s3.amazonaws.com/photos/63505592/original.jpeg&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q24082749&#39;}]}}},
 &#39;Cyperus sphacelatus&#39;: {&#39;wd_uri&#39;: &#39;http://www.wikidata.org/entity/Q15535602&#39;,
  &#39;publisher&#39;: {&#39;The New York Botanical Garden&#39;: {&#39;observations&#39;: [{&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1931343141&#39;,
      &#39;media&#39;: [&#39;http://sweetgum.nybg.org/images3/388/936/v-035-01294643.jpg&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;},
     {&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1930054406&#39;,
      &#39;media&#39;: [&#39;http://sweetgum.nybg.org/images3/388/935/v-035-01294642.jpg&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;}]},
   &#39;nan&#39;: {&#39;observations&#39;: [{&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1321055822&#39;,
      &#39;media&#39;: [&#39;http://n2t.net/ark:/65665/m3e83ead2f-aab3-4241-9551-ee02b8ed0995&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;},
     {&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1318020074&#39;,
      &#39;media&#39;: [&#39;http://n2t.net/ark:/65665/m32497bce4-176b-43d3-8427-e7d06fe3b913&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;}]}}},
 &#39;Anthephora hermaphrodita&#39;: {&#39;wd_uri&#39;: &#39;http://www.wikidata.org/entity/Q15504902&#39;,
  &#39;publisher&#39;: {&#39;The New York Botanical Garden&#39;: {&#39;observations&#39;: [{&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1931292498&#39;,
      &#39;media&#39;: [&#39;http://sweetgum.nybg.org/images3/770/634/01362522.jpg&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;}]},
   &#39;nan&#39;: {&#39;observations&#39;: [{&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1322619497&#39;,
      &#39;media&#39;: [&#39;http://n2t.net/ark:/65665/m3ee367c1b-d387-4015-83cb-2cd7838af38d&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;},
     {&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1322619497&#39;,
      &#39;media&#39;: [&#39;http://n2t.net/ark:/65665/m3e9d3fb8c-d5b1-4ed1-a03e-f4e1a9ef2059&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;},
     {&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1322614438&#39;,
      &#39;media&#39;: [&#39;http://n2t.net/ark:/65665/m32d4b365d-b12d-46c3-a548-4bc9add61e57&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;},
     {&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1320100491&#39;,
      &#39;media&#39;: [&#39;http://n2t.net/ark:/65665/m3140f66a1-e14d-48e1-b859-a9cd019ffd21&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;}]}}},
 &#39;Andropogon bicornis&#39;: {&#39;wd_uri&#39;: &#39;http://www.wikidata.org/entity/Q15504478&#39;,
  &#39;publisher&#39;: {&#39;The New York Botanical Garden&#39;: {&#39;observations&#39;: [{&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1931213785&#39;,
      &#39;media&#39;: [&#39;http://sweetgum.nybg.org/images3/753/211/01074826.jpg&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;}]},
   &#39;nan&#39;: {&#39;observations&#39;: [{&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1319765399&#39;,
      &#39;media&#39;: [&#39;http://n2t.net/ark:/65665/m3ddeeecc9-d742-4fb2-8692-8429298b10d6&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;}]}}},
 &#39;Cenchrus echinatus&#39;: {&#39;wd_uri&#39;: &#39;http://www.wikidata.org/entity/Q4925284&#39;,
  &#39;publisher&#39;: {&#39;The New York Botanical Garden&#39;: {&#39;observations&#39;: [{&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1930775886&#39;,
      &#39;media&#39;: [&#39;http://sweetgum.nybg.org/images3/774/277/01530381.jpg&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;}]},
   &#39;nan&#39;: {&#39;observations&#39;: [{&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1322273361&#39;,
      &#39;media&#39;: [&#39;http://n2t.net/ark:/65665/m3d3700d89-c45b-4c38-9904-10d6227ccd65&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;}]}}},
 &#39;Scleria secans&#39;: {&#39;wd_uri&#39;: &#39;http://www.wikidata.org/entity/Q15564658&#39;,
  &#39;publisher&#39;: {&#39;The New York Botanical Garden&#39;: {&#39;observations&#39;: [{&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1930711924&#39;,
      &#39;media&#39;: [&#39;http://sweetgum.nybg.org/images3/395/081/v-035-01333783.jpg&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;}]},
   &#39;nan&#39;: {&#39;observations&#39;: [{&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1319347135&#39;,
      &#39;media&#39;: [&#39;http://n2t.net/ark:/65665/m32abeac53-a893-408c-b615-c360c3c8c337&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;}]}}},
 &#39;Cyperus alopecuroides&#39;: {&#39;wd_uri&#39;: &#39;http://www.wikidata.org/entity/Q6539452&#39;,
  &#39;publisher&#39;: {&#39;The New York Botanical Garden&#39;: {&#39;observations&#39;: [{&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1930329432&#39;,
      &#39;media&#39;: [&#39;http://sweetgum.nybg.org/images3/379/050/v-035-01270956.jpg&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;}]},
   &#39;nan&#39;: {&#39;observations&#39;: [{&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1322526038&#39;,
      &#39;media&#39;: [&#39;http://n2t.net/ark:/65665/m36812aa30-174b-49e4-8040-0d68cdaa03ec&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;},
     {&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1319852739&#39;,
      &#39;media&#39;: [&#39;http://n2t.net/ark:/65665/m35b122118-0d35-4fc5-8e8c-dd9b1246b7d8&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;}]}}},
 &#39;Coix lacryma-jobi&#39;: {&#39;wd_uri&#39;: &#39;http://www.wikidata.org/entity/Q827098&#39;,
  &#39;publisher&#39;: {&#39;The New York Botanical Garden&#39;: {&#39;observations&#39;: [{&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1929543708&#39;,
      &#39;media&#39;: [&#39;http://sweetgum.nybg.org/images3/774/861/01530977.jpg&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;}]},
   &#39;nan&#39;: {&#39;observations&#39;: [{&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1319691867&#39;,
      &#39;media&#39;: [&#39;http://n2t.net/ark:/65665/m3920f6c1b-cff0-456e-b6b6-7442de336ee9&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;}]}}},
 &#39;Aristida adscensionis&#39;: {&#39;wd_uri&#39;: &#39;http://www.wikidata.org/entity/Q4790962&#39;,
  &#39;publisher&#39;: {&#39;The New York Botanical Garden&#39;: {&#39;observations&#39;: [{&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1929536046&#39;,
      &#39;media&#39;: [&#39;http://sweetgum.nybg.org/images3/770/640/01362559.jpg&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;},
     {&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1929146168&#39;,
      &#39;media&#39;: [&#39;http://sweetgum.nybg.org/images3/770/702/01362622.jpg&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;}]},
   &#39;nan&#39;: {&#39;observations&#39;: [{&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1320124280&#39;,
      &#39;media&#39;: [&#39;http://n2t.net/ark:/65665/m337ff97b3-8440-4e49-9e87-3fdc2a543e35&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;}]}}},
 &#39;Panicum trichoides&#39;: {&#39;wd_uri&#39;: &#39;http://www.wikidata.org/entity/Q10912779&#39;,
  &#39;publisher&#39;: {&#39;The New York Botanical Garden&#39;: {&#39;observations&#39;: [{&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1929461864&#39;,
      &#39;media&#39;: [&#39;http://sweetgum.nybg.org/images3/794/648/1605047.jpg&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;},
     {&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1929233297&#39;,
      &#39;media&#39;: [&#39;http://sweetgum.nybg.org/images3/794/649/1605048.jpg&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;}]},
   &#39;nan&#39;: {&#39;observations&#39;: [{&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1321827285&#39;,
      &#39;media&#39;: [&#39;http://n2t.net/ark:/65665/m31d2ae640-4b6b-4399-a7d7-50e02ec7a5ae&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;},
     {&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1321414054&#39;,
      &#39;media&#39;: [&#39;http://n2t.net/ark:/65665/m3794f5c78-9cc6-4a25-be08-64688f600cf1&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;}]}}},
 &#39;Paspalum conjugatum&#39;: {&#39;wd_uri&#39;: &#39;http://www.wikidata.org/entity/Q3367780&#39;,
  &#39;publisher&#39;: {&#39;The New York Botanical Garden&#39;: {&#39;observations&#39;: [{&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1929349611&#39;,
      &#39;media&#39;: [&#39;http://sweetgum.nybg.org/images3/810/542/1605551.jpg&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;}]},
   &#39;nan&#39;: {&#39;observations&#39;: [{&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1319483254&#39;,
      &#39;media&#39;: [&#39;http://n2t.net/ark:/65665/m3743fa566-3bb6-447d-a236-3c31b333df81&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;}]}}},
 &#39;Digitaria insularis&#39;: {&#39;wd_uri&#39;: &#39;http://www.wikidata.org/entity/Q14834635&#39;,
  &#39;publisher&#39;: {&#39;The New York Botanical Garden&#39;: {&#39;observations&#39;: [{&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1929080778&#39;,
      &#39;media&#39;: [&#39;http://sweetgum.nybg.org/images3/777/519/1601282.jpg&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;},
     {&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1928936802&#39;,
      &#39;media&#39;: [&#39;http://sweetgum.nybg.org/images3/791/076/1601390.jpg&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;}]},
   &#39;nan&#39;: {&#39;observations&#39;: [{&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1321074052&#39;,
      &#39;media&#39;: [&#39;http://n2t.net/ark:/65665/m33230bbd7-7dc1-4a2f-87d1-2931b277dd3d&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;}]}}},
 &#39;Rhynchospora tenerrima&#39;: {&#39;wd_uri&#39;: &#39;http://www.wikidata.org/entity/Q15557622&#39;,
  &#39;publisher&#39;: {&#39;The New York Botanical Garden&#39;: {&#39;observations&#39;: [{&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1928397665&#39;,
      &#39;media&#39;: [&#39;http://sweetgum.nybg.org/images3/394/196/v-035-01298444.jpg&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;}]},
   &#39;nan&#39;: {&#39;observations&#39;: [{&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1322604769&#39;,
      &#39;media&#39;: [&#39;http://n2t.net/ark:/65665/m325c1df88-3d00-4190-94c7-f53733efdc9e&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;}]}}},
 &#39;Fimbristylis complanata&#39;: {&#39;wd_uri&#39;: &#39;http://www.wikidata.org/entity/Q11075670&#39;,
  &#39;publisher&#39;: {&#39;The New York Botanical Garden&#39;: {&#39;observations&#39;: [{&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1928078543&#39;,
      &#39;media&#39;: [&#39;http://sweetgum.nybg.org/images3/387/486/v-035-01295992.jpg&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;}]},
   &#39;nan&#39;: {&#39;observations&#39;: [{&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1320302063&#39;,
      &#39;media&#39;: [&#39;http://n2t.net/ark:/65665/m31fc6a10b-0312-48a6-b36a-e61a21a54136&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;}]}}},
 &#39;Paspalum fimbriatum&#39;: {&#39;wd_uri&#39;: &#39;http://www.wikidata.org/entity/Q15246196&#39;,
  &#39;publisher&#39;: {&#39;nan&#39;: {&#39;observations&#39;: [{&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1321897722&#39;,
      &#39;media&#39;: [&#39;http://n2t.net/ark:/65665/m3d17976b2-2717-4b55-8eb9-8e46c9f44ed4&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;}]}}},
 &#39;Lasiacis sorghoidea&#39;: {&#39;wd_uri&#39;: &#39;http://www.wikidata.org/entity/Q15508551&#39;,
  &#39;publisher&#39;: {&#39;nan&#39;: {&#39;observations&#39;: [{&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1321232984&#39;,
      &#39;media&#39;: [&#39;http://n2t.net/ark:/65665/m38cb51a1f-9a2a-4969-a796-4cb581c48cb6&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;},
     {&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1319576896&#39;,
      &#39;media&#39;: [&#39;http://n2t.net/ark:/65665/m335a88ded-0c27-4648-aa96-70566c9c2ea6&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;},
     {&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1317605282&#39;,
      &#39;media&#39;: [&#39;http://n2t.net/ark:/65665/m3ee659b97-28e1-404e-8d76-408fb5d805e0&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;}]}}},
 &#39;Digitaria bicornis&#39;: {&#39;wd_uri&#39;: &#39;http://www.wikidata.org/entity/Q11066188&#39;,
  &#39;publisher&#39;: {&#39;nan&#39;: {&#39;observations&#39;: [{&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1319816085&#39;,
      &#39;media&#39;: [&#39;http://n2t.net/ark:/65665/m365b45363-4142-41fc-a6a1-dd0bc8330450&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;}]}}},
 &#39;Brachiaria fasciculata&#39;: {&#39;wd_uri&#39;: &#39;http://www.wikidata.org/entity/Q15509620&#39;,
  &#39;publisher&#39;: {&#39;nan&#39;: {&#39;observations&#39;: [{&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1317614158&#39;,
      &#39;media&#39;: [&#39;http://n2t.net/ark:/65665/m30612c7f4-df88-4fbb-b508-cb574264bef3&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;}]}}},
 &#39;Machaerina restioides&#39;: {&#39;wd_uri&#39;: &#39;http://www.wikidata.org/entity/Q15550242&#39;,
  &#39;publisher&#39;: {&#39;nan&#39;: {&#39;observations&#39;: [{&#39;observation_id&#39;: &#39;https://www.gbif.org/occurrence/1056947532&#39;,
      &#39;media&#39;: [&#39;https://data.nhm.ac.uk/media/ebea390a-3806-4e43-8315-6174d0eacc12&#39;],
      &#39;license&#39;: &#39;http://www.wikidata.org/entity/Q18199165&#39;}]}}}}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="s1">&#39;./taxa/&#39;</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="s1">&#39;./taxa/&#39;</span><span class="p">),</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">resolve_license_label</span><span class="p">(</span><span class="n">license_uri</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert a Wikidata license URI to a human-readable label.&quot;&quot;&quot;</span>
    <span class="n">license_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;Q18199165&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;CC BY 4.0&#39;</span><span class="p">,</span>       <span class="s1">&#39;https://creativecommons.org/licenses/by/4.0/&#39;</span><span class="p">),</span>
        <span class="s1">&#39;Q20007257&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;CC BY-SA 4.0&#39;</span><span class="p">,</span>    <span class="s1">&#39;https://creativecommons.org/licenses/by-sa/4.0/&#39;</span><span class="p">),</span>
        <span class="s1">&#39;Q6938433&#39;</span><span class="p">:</span>  <span class="p">(</span><span class="s1">&#39;CC0 1.0&#39;</span><span class="p">,</span>         <span class="s1">&#39;https://creativecommons.org/publicdomain/zero/1.0/&#39;</span><span class="p">),</span>
        <span class="s1">&#39;Q19068220&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;CC BY-NC 4.0&#39;</span><span class="p">,</span>    <span class="s1">&#39;https://creativecommons.org/licenses/by-nc/4.0/&#39;</span><span class="p">),</span>
        <span class="s1">&#39;Q26952697&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;CC BY-NC-SA 4.0&#39;</span><span class="p">,</span> <span class="s1">&#39;https://creativecommons.org/licenses/by-nc-sa/4.0/&#39;</span><span class="p">),</span>
        <span class="s1">&#39;Q35254&#39;</span><span class="p">:</span>    <span class="p">(</span><span class="s1">&#39;CC BY-SA 3.0&#39;</span><span class="p">,</span>    <span class="s1">&#39;https://creativecommons.org/licenses/by-sa/3.0/&#39;</span><span class="p">),</span>
        <span class="s1">&#39;Q24082749&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;CC BY-SA 4.0&#39;</span><span class="p">,</span>    <span class="s1">&#39;https://creativecommons.org/licenses/by-sa/4.0/&#39;</span><span class="p">),</span>
        <span class="s1">&#39;Q62322Plain&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;CC BY 4.0&#39;</span><span class="p">,</span>     <span class="s1">&#39;https://creativecommons.org/licenses/by/4.0/&#39;</span><span class="p">),</span>
    <span class="p">}</span>
    <span class="n">s</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">license_uri</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;wikidata.org/entity/Q&#39;</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
        <span class="n">qid</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">qid</span> <span class="ow">in</span> <span class="n">license_map</span><span class="p">:</span>
            <span class="n">label</span><span class="p">,</span> <span class="n">url</span> <span class="o">=</span> <span class="n">license_map</span><span class="p">[</span><span class="n">qid</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">label</span><span class="p">,</span> <span class="n">url</span>
        <span class="k">return</span> <span class="n">qid</span><span class="p">,</span> <span class="n">s</span>
    <span class="c1"># Already a CC URL</span>
    <span class="n">s_lower</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">if</span> <span class="s1">&#39;publicdomain/zero&#39;</span> <span class="ow">in</span> <span class="n">s_lower</span><span class="p">:</span>   <span class="k">return</span> <span class="s1">&#39;CC0 1.0&#39;</span><span class="p">,</span> <span class="n">s</span>
    <span class="k">if</span> <span class="s1">&#39;by-nc-sa&#39;</span> <span class="ow">in</span> <span class="n">s_lower</span><span class="p">:</span>           <span class="k">return</span> <span class="s1">&#39;CC BY-NC-SA 4.0&#39;</span><span class="p">,</span> <span class="n">s</span>
    <span class="k">if</span> <span class="s1">&#39;by-nc&#39;</span> <span class="ow">in</span> <span class="n">s_lower</span><span class="p">:</span>              <span class="k">return</span> <span class="s1">&#39;CC BY-NC 4.0&#39;</span><span class="p">,</span> <span class="n">s</span>
    <span class="k">if</span> <span class="s1">&#39;by-sa&#39;</span> <span class="ow">in</span> <span class="n">s_lower</span><span class="p">:</span>              <span class="k">return</span> <span class="s1">&#39;CC BY-SA 4.0&#39;</span><span class="p">,</span> <span class="n">s</span>
    <span class="k">if</span> <span class="s1">&#39;by&#39;</span> <span class="ow">in</span> <span class="n">s_lower</span><span class="p">:</span>                 <span class="k">return</span> <span class="s1">&#39;CC BY 4.0&#39;</span><span class="p">,</span> <span class="n">s</span>
    <span class="k">return</span> <span class="n">s</span><span class="p">,</span> <span class="n">s</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;resolve_license_label() defined.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">taxon</span> <span class="ow">in</span> <span class="n">taxonpages</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="n">mdFile</span> <span class="o">=</span> <span class="n">MdUtils</span><span class="p">(</span><span class="n">file_name</span><span class="o">=</span><span class="s1">&#39;taxa/&#39;</span><span class="o">+</span> <span class="n">taxon</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="n">taxon</span><span class="o">+</span><span class="s1">&#39; (&#39;</span><span class="o">+</span><span class="n">taxonpages</span><span class="p">[</span><span class="n">taxon</span><span class="p">][</span><span class="s1">&#39;wd_uri&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;http://www.wikidata.org/entity/&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;)&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">URIRef</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;taxon&#39;</span><span class="p">])</span> <span class="ow">in</span> <span class="n">taxoninformation</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">if</span> <span class="s1">&#39;wikiintroduction&#39;</span> <span class="ow">in</span> <span class="n">taxoninformation</span><span class="p">[</span><span class="n">URIRef</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;taxon&#39;</span><span class="p">])]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">mdFile</span><span class="o">.</span><span class="n">new_line</span><span class="p">(</span><span class="n">taxoninformation</span><span class="p">[</span><span class="n">URIRef</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;taxon&#39;</span><span class="p">])][</span><span class="s1">&#39;wikiintroduction&#39;</span><span class="p">])</span>
            <span class="n">mdFile</span><span class="o">.</span><span class="n">new_line</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Read more on [English Wikipedia](https://en.wikipedia.org/page/</span><span class="si">{</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;taxonLabel&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="n">mdFile</span><span class="o">.</span><span class="n">new_line</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Visualize Wikidata on [Scholia](https://scholia.toolforge.org/taxon/</span><span class="si">{</span><span class="n">taxonpages</span><span class="p">[</span><span class="n">taxon</span><span class="p">][</span><span class="s1">&#39;wd_uri&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;http://www.wikidata.org/entity/&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">organisation</span> <span class="ow">in</span> <span class="n">taxonpages</span><span class="p">[</span><span class="n">taxon</span><span class="p">][</span><span class="s1">&#39;publisher&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">mdFile</span><span class="o">.</span><span class="n">new_header</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">organisation</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">observation</span> <span class="ow">in</span> <span class="n">taxonpages</span><span class="p">[</span><span class="n">taxon</span><span class="p">][</span><span class="s1">&#39;publisher&#39;</span><span class="p">][</span><span class="n">organisation</span><span class="p">][</span><span class="s1">&#39;observations&#39;</span><span class="p">]:</span>
            <span class="n">mdFile</span><span class="o">.</span><span class="n">new_line</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Observation: [</span><span class="si">{</span><span class="n">observation</span><span class="p">[</span><span class="s1">&#39;observation_id&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">](</span><span class="si">{</span><span class="n">observation</span><span class="p">[</span><span class="s1">&#39;observation_id&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">license_label</span><span class="p">,</span> <span class="n">license_url</span> <span class="o">=</span> <span class="n">resolve_license_label</span><span class="p">(</span><span class="n">observation</span><span class="p">[</span><span class="s1">&#39;license&#39;</span><span class="p">])</span>
            <span class="n">mdFile</span><span class="o">.</span><span class="n">new_line</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;License: [</span><span class="si">{</span><span class="n">license_label</span><span class="si">}</span><span class="s2">](</span><span class="si">{</span><span class="n">license_url</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">media</span> <span class="ow">in</span> <span class="n">observation</span><span class="p">[</span><span class="s1">&#39;media&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">media</span> <span class="o">!=</span> <span class="s1">&#39;nan&#39;</span><span class="p">:</span>
                    <span class="n">mdFile</span><span class="o">.</span><span class="n">new_line</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;![</span><span class="si">{</span><span class="n">observation</span><span class="p">[</span><span class="s1">&#39;observation_id&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">](</span><span class="si">{</span><span class="n">media</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;square&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;medium&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="n">mdFile</span><span class="o">.</span><span class="n">create_md_file</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">organization_to_taxa</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">taxon</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">taxonpages</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">organisation</span><span class="p">,</span> <span class="n">org_data</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;publisher&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">organisation</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">organization_to_taxa</span><span class="p">:</span>
            <span class="n">organization_to_taxa</span><span class="p">[</span><span class="n">organisation</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">organization_to_taxa</span><span class="p">[</span><span class="n">organisation</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">&#39;taxon&#39;</span><span class="p">:</span> <span class="n">taxon</span><span class="p">,</span>
            <span class="s1">&#39;taxon_uri&#39;</span><span class="p">:</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;wd_uri&#39;</span><span class="p">],</span>
            <span class="s1">&#39;observations&#39;</span><span class="p">:</span> <span class="n">org_data</span><span class="p">[</span><span class="s1">&#39;observations&#39;</span><span class="p">]</span>
        <span class="p">})</span>

<span class="k">for</span> <span class="n">organisation</span><span class="p">,</span> <span class="n">taxa</span> <span class="ow">in</span> <span class="n">organization_to_taxa</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">mdFile</span> <span class="o">=</span> <span class="n">MdUtils</span><span class="p">(</span><span class="n">file_name</span><span class="o">=</span><span class="s1">&#39;organisation/&#39;</span> <span class="o">+</span> <span class="n">organisation</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="n">organisation</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">taxon_data</span> <span class="ow">in</span> <span class="n">taxa</span><span class="p">:</span>
        <span class="n">taxon</span> <span class="o">=</span> <span class="n">taxon_data</span><span class="p">[</span><span class="s1">&#39;taxon&#39;</span><span class="p">]</span>
        <span class="n">taxon_uri</span> <span class="o">=</span> <span class="n">taxon_data</span><span class="p">[</span><span class="s1">&#39;taxon_uri&#39;</span><span class="p">]</span>
        <span class="n">observations</span> <span class="o">=</span> <span class="n">taxon_data</span><span class="p">[</span><span class="s1">&#39;observations&#39;</span><span class="p">]</span>

        <span class="n">mdFile</span><span class="o">.</span><span class="n">new_header</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="n">taxon</span> <span class="o">+</span> <span class="s1">&#39; (&#39;</span> <span class="o">+</span> <span class="n">taxon_uri</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;http://www.wikidata.org/entity/&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">URIRef</span><span class="p">(</span><span class="n">taxon_uri</span><span class="p">)</span> <span class="ow">in</span> <span class="n">taxoninformation</span><span class="p">:</span>
            <span class="n">taxon_info</span> <span class="o">=</span> <span class="n">taxoninformation</span><span class="p">[</span><span class="n">URIRef</span><span class="p">(</span><span class="n">taxon_uri</span><span class="p">)]</span>
            <span class="k">if</span> <span class="s1">&#39;wikiintroduction&#39;</span> <span class="ow">in</span> <span class="n">taxon_info</span><span class="p">:</span>
                <span class="n">mdFile</span><span class="o">.</span><span class="n">new_line</span><span class="p">(</span><span class="n">taxon_info</span><span class="p">[</span><span class="s1">&#39;wikiintroduction&#39;</span><span class="p">])</span>
                <span class="n">mdFile</span><span class="o">.</span><span class="n">new_line</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Read more on [English Wikipedia](https://en.wikipedia.org/page/</span><span class="si">{</span><span class="n">taxon</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

        <span class="n">mdFile</span><span class="o">.</span><span class="n">new_line</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Visualize Wikidata on [Scholia](https://scholia.toolforge.org/taxon/</span><span class="si">{</span><span class="n">taxon_uri</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;http://www.wikidata.org/entity/&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">observation</span> <span class="ow">in</span> <span class="n">observations</span><span class="p">:</span>
            <span class="n">mdFile</span><span class="o">.</span><span class="n">new_line</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Observation: [</span><span class="si">{</span><span class="n">observation</span><span class="p">[</span><span class="s1">&#39;observation_id&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">](</span><span class="si">{</span><span class="n">observation</span><span class="p">[</span><span class="s1">&#39;observation_id&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="n">license_label</span><span class="p">,</span> <span class="n">license_url</span> <span class="o">=</span> <span class="n">resolve_license_label</span><span class="p">(</span><span class="n">observation</span><span class="p">[</span><span class="s1">&#39;license&#39;</span><span class="p">])</span>
            <span class="n">mdFile</span><span class="o">.</span><span class="n">new_line</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;License: [</span><span class="si">{</span><span class="n">license_label</span><span class="si">}</span><span class="s2">](</span><span class="si">{</span><span class="n">license_url</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">media</span> <span class="ow">in</span> <span class="n">observation</span><span class="p">[</span><span class="s1">&#39;media&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">media</span> <span class="o">!=</span> <span class="s1">&#39;nan&#39;</span><span class="p">:</span>
                    <span class="n">mdFile</span><span class="o">.</span><span class="n">new_line</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;![</span><span class="si">{</span><span class="n">observation</span><span class="p">[</span><span class="s1">&#39;observation_id&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">](</span><span class="si">{</span><span class="n">media</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;square&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;medium&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>

    <span class="n">mdFile</span><span class="o">.</span><span class="n">create_md_file</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">yaml</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;_toc.yml&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="c1"># The FullLoader parameter handles the conversion from YAML</span>
    <span class="c1"># scalar values to Python the dictionary format</span>
    <span class="n">species</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">Loader</span><span class="o">=</span><span class="n">yaml</span><span class="o">.</span><span class="n">FullLoader</span><span class="p">)</span>

<span class="n">species</span><span class="p">[</span><span class="s2">&quot;parts&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;chapters&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">&#39;./organisation/&#39;</span><span class="p">):</span>
    <span class="n">species</span><span class="p">[</span><span class="s2">&quot;parts&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;chapters&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="s1">&#39;organisation/&#39;</span><span class="o">+</span><span class="n">file</span><span class="p">})</span>

<span class="n">species</span><span class="p">[</span><span class="s2">&quot;parts&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;chapters&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">&#39;./taxa/&#39;</span><span class="p">):</span>
    <span class="n">species</span><span class="p">[</span><span class="s2">&quot;parts&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;chapters&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;file&#39;</span><span class="p">:</span> <span class="s1">&#39;taxa/&#39;</span><span class="o">+</span><span class="n">file</span><span class="p">})</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;_toc.yml&#39;</span><span class="p">,</span> <span class="s1">&#39;w+&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="n">documents</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">species</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="below-is-for-reference-only">
<h2>Below is for reference only<a class="headerlink" href="#below-is-for-reference-only" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Assuming `notFound` is your dictionary</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># List to hold data for DataFrame</span>

<span class="k">for</span> <span class="n">institute</span><span class="p">,</span> <span class="n">details</span> <span class="ow">in</span> <span class="n">notFound</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Access the first result for the current institute</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">details</span><span class="p">[</span><span class="s2">&quot;results&quot;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># If no results are found, append a dictionary with the institute and an error message</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No results found for </span><span class="si">{</span><span class="n">institute</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s2">&quot;Institute&quot;</span><span class="p">:</span> <span class="s2">&quot;FOUT&quot;</span> <span class="o">+</span> <span class="n">institute</span><span class="p">,</span>
                <span class="s2">&quot;Error&quot;</span><span class="p">:</span> <span class="s2">&quot;No results found&quot;</span>
            <span class="p">})</span>
            <span class="k">continue</span>
        <span class="n">first_result</span> <span class="o">=</span> <span class="n">details</span><span class="p">[</span><span class="s2">&quot;results&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

        <span class="c1"># Append a dictionary with the required information to the data list</span>
        <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s2">&quot;Institute&quot;</span><span class="p">:</span> <span class="n">institute</span><span class="p">,</span>
            <span class="s2">&quot;Key&quot;</span><span class="p">:</span> <span class="n">first_result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="s2">&quot;Title&quot;</span><span class="p">:</span> <span class="n">first_result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="s2">&quot;Homepage&quot;</span><span class="p">:</span> <span class="n">first_result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;homepage&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="s2">&quot;City&quot;</span><span class="p">:</span> <span class="n">first_result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;city&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="s2">&quot;Country&quot;</span><span class="p">:</span> <span class="n">first_result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;country&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="s2">&quot;PostalCode&quot;</span><span class="p">:</span> <span class="n">first_result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;postalCode&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="s2">&quot;Address&quot;</span><span class="p">:</span> <span class="n">first_result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;address&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="s2">&quot;Phone&quot;</span><span class="p">:</span> <span class="n">first_result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;phone&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="s2">&quot;Email&quot;</span><span class="p">:</span> <span class="n">first_result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;email&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="s2">&quot;Endpoints&quot;</span><span class="p">:</span> <span class="n">first_result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;endpoints&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="p">})</span>
    <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="c1"># If some data is not found, append a dictionary with the institute and an error message</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error retrieving data for </span><span class="si">{</span><span class="n">institute</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s2">&quot;Institute&quot;</span><span class="p">:</span> <span class="s2">&quot;FOUT&quot;</span> <span class="o">+</span> <span class="n">institute</span><span class="p">,</span>
            <span class="s2">&quot;Error&quot;</span><span class="p">:</span> <span class="n">details</span><span class="p">[</span><span class="s2">&quot;results&quot;</span><span class="p">]</span>
        <span class="p">})</span>

<span class="c1"># Create DataFrame from the data list</span>
<span class="n">dfinstitutestoBuild</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">dfinstitutestoBuild</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No results found for Delmaude C Ryan
No results found for slauren
No results found for gorillarebecca
No results found for monkeyjodey
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Institute</th>
      <th>Error</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>FOUTDelmaude C Ryan</td>
      <td>No results found</td>
    </tr>
    <tr>
      <th>1</th>
      <td>FOUTslauren</td>
      <td>No results found</td>
    </tr>
    <tr>
      <th>2</th>
      <td>FOUTgorillarebecca</td>
      <td>No results found</td>
    </tr>
    <tr>
      <th>3</th>
      <td>FOUTmonkeyjodey</td>
      <td>No results found</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;license&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gbifID</th>
      <th>accessRights</th>
      <th>bibliographicCitation</th>
      <th>language</th>
      <th>modified</th>
      <th>publisher</th>
      <th>references</th>
      <th>rightsHolder</th>
      <th>type</th>
      <th>institutionID</th>
      <th>...</th>
      <th>publishedByGbifRegion</th>
      <th>level0Gid</th>
      <th>level0Name</th>
      <th>level1Gid</th>
      <th>level1Name</th>
      <th>level2Gid</th>
      <th>level2Name</th>
      <th>level3Gid</th>
      <th>level3Name</th>
      <th>iucnRedListCategory</th>
    </tr>
    <tr>
      <th>license</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>CC0_1_0</th>
      <td>74</td>
      <td>0</td>
      <td>0</td>
      <td>19</td>
      <td>53</td>
      <td>0</td>
      <td>47</td>
      <td>46</td>
      <td>19</td>
      <td>45</td>
      <td>...</td>
      <td>74</td>
      <td>27</td>
      <td>27</td>
      <td>27</td>
      <td>27</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>73</td>
    </tr>
    <tr>
      <th>CC_BY_4_0</th>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>...</td>
      <td>4</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>CC_BY_NC_4_0</th>
      <td>9</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>8</td>
      <td>0</td>
      <td>8</td>
      <td>8</td>
      <td>1</td>
      <td>2</td>
      <td>...</td>
      <td>9</td>
      <td>7</td>
      <td>7</td>
      <td>7</td>
      <td>7</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>9</td>
    </tr>
  </tbody>
</table>
<p>3 rows × 222 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;iucnRedListCategory&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gbifID</th>
      <th>accessRights</th>
      <th>bibliographicCitation</th>
      <th>language</th>
      <th>license</th>
      <th>modified</th>
      <th>publisher</th>
      <th>references</th>
      <th>rightsHolder</th>
      <th>type</th>
      <th>...</th>
      <th>gbifRegion</th>
      <th>publishedByGbifRegion</th>
      <th>level0Gid</th>
      <th>level0Name</th>
      <th>level1Gid</th>
      <th>level1Name</th>
      <th>level2Gid</th>
      <th>level2Name</th>
      <th>level3Gid</th>
      <th>level3Name</th>
    </tr>
    <tr>
      <th>iucnRedListCategory</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>LC</th>
      <td>41</td>
      <td>0</td>
      <td>0</td>
      <td>11</td>
      <td>41</td>
      <td>28</td>
      <td>0</td>
      <td>24</td>
      <td>25</td>
      <td>13</td>
      <td>...</td>
      <td>41</td>
      <td>41</td>
      <td>14</td>
      <td>14</td>
      <td>14</td>
      <td>14</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>NE</th>
      <td>45</td>
      <td>0</td>
      <td>0</td>
      <td>8</td>
      <td>45</td>
      <td>35</td>
      <td>0</td>
      <td>30</td>
      <td>30</td>
      <td>9</td>
      <td>...</td>
      <td>45</td>
      <td>45</td>
      <td>21</td>
      <td>21</td>
      <td>21</td>
      <td>21</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 222 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;higherClassification&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gbifID</th>
      <th>accessRights</th>
      <th>bibliographicCitation</th>
      <th>language</th>
      <th>license</th>
      <th>modified</th>
      <th>publisher</th>
      <th>references</th>
      <th>rightsHolder</th>
      <th>type</th>
      <th>...</th>
      <th>publishedByGbifRegion</th>
      <th>level0Gid</th>
      <th>level0Name</th>
      <th>level1Gid</th>
      <th>level1Name</th>
      <th>level2Gid</th>
      <th>level2Name</th>
      <th>level3Gid</th>
      <th>level3Name</th>
      <th>iucnRedListCategory</th>
    </tr>
    <tr>
      <th>higherClassification</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Cyperaceae</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>POACEAE</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Plantae, Monocotyledonae, Poales, Cyperaceae, Cyperoideae</th>
      <td>7</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>7</td>
      <td>7</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>7</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>7</td>
    </tr>
    <tr>
      <th>Plantae, Monocotyledonae, Poales, Poaceae, Aristidoideae</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Plantae, Monocotyledonae, Poales, Poaceae, Panicoideae</th>
      <td>18</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>18</td>
      <td>18</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>18</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>18</td>
    </tr>
    <tr>
      <th>Plantae|Spermatophyta|Tracheophyta|Magnoliophyta|Monocots|Commelinids|Poales|Cyperaceae|Cyperus</th>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>...</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Plantae|Spermatophyta|Tracheophyta|Magnoliophyta|Monocots|Commelinids|Poales|Cyperaceae|Fimbristylis</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Plantae|Spermatophyta|Tracheophyta|Magnoliophyta|Monocots|Commelinids|Poales|Cyperaceae|Scleria</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Plantae|Spermatophyta|Tracheophyta|Magnoliophyta|Monocots|Commelinids|Poales|Poaceae|Anthephora</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Plantae|Spermatophyta|Tracheophyta|Magnoliophyta|Monocots|Commelinids|Poales|Poaceae|Digitaria</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Plantae|Spermatophyta|Tracheophyta|Magnoliophyta|Monocots|Commelinids|Poales|Poaceae|Lasiacis</th>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
      <td>...</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Plantae|Spermatophyta|Tracheophyta|Magnoliophyta|Monocots|Commelinids|Poales|Poaceae|Lasiacis|Lasiacis divaricata</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Plantae|Spermatophyta|Tracheophyta|Magnoliophyta|Monocots|Commelinids|Poales|Poaceae|Panicum</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Plantae|Spermatophyta|Tracheophyta|Magnoliophyta|Monocots|Commelinids|Poales|Poaceae|Paspalum</th>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
      <td>...</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Poaceae</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>15 rows × 222 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;species&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()[[</span><span class="s2">&quot;higherClassification&quot;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>higherClassification</th>
    </tr>
    <tr>
      <th>species</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Andropogon bicornis</th>
      <td>1</td>
    </tr>
    <tr>
      <th>Anthephora hermaphrodita</th>
      <td>4</td>
    </tr>
    <tr>
      <th>Aristida adscensionis</th>
      <td>1</td>
    </tr>
    <tr>
      <th>Axonopus compressus</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Bambusa vulgaris</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Cenchrus echinatus</th>
      <td>1</td>
    </tr>
    <tr>
      <th>Coix lacryma-jobi</th>
      <td>1</td>
    </tr>
    <tr>
      <th>Cymbopogon citratus</th>
      <td>1</td>
    </tr>
    <tr>
      <th>Cyperus alopecuroides</th>
      <td>2</td>
    </tr>
    <tr>
      <th>Cyperus brevifolius</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Cyperus sphacelatus</th>
      <td>4</td>
    </tr>
    <tr>
      <th>Digitaria bicornis</th>
      <td>1</td>
    </tr>
    <tr>
      <th>Digitaria insularis</th>
      <td>2</td>
    </tr>
    <tr>
      <th>Eleocharis flavescens</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Eriochloa punctata</th>
      <td>1</td>
    </tr>
    <tr>
      <th>Fimbristylis complanata</th>
      <td>2</td>
    </tr>
    <tr>
      <th>Lasiacis divaricata</th>
      <td>3</td>
    </tr>
    <tr>
      <th>Lasiacis maculata</th>
      <td>6</td>
    </tr>
    <tr>
      <th>Machaerina restioides</th>
      <td>1</td>
    </tr>
    <tr>
      <th>Melinis repens</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Panicum trichoides</th>
      <td>3</td>
    </tr>
    <tr>
      <th>Paspalum conjugatum</th>
      <td>2</td>
    </tr>
    <tr>
      <th>Paspalum fimbriatum</th>
      <td>3</td>
    </tr>
    <tr>
      <th>Rhynchospora nervosa</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Rhynchospora tenerrima</th>
      <td>1</td>
    </tr>
    <tr>
      <th>Scleria secans</th>
      <td>2</td>
    </tr>
    <tr>
      <th>Sporobolus virginicus</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Urochloa fusca</th>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;species&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gbifID</th>
      <th>accessRights</th>
      <th>bibliographicCitation</th>
      <th>language</th>
      <th>license</th>
      <th>modified</th>
      <th>publisher</th>
      <th>references</th>
      <th>rightsHolder</th>
      <th>type</th>
      <th>...</th>
      <th>publishedByGbifRegion</th>
      <th>level0Gid</th>
      <th>level0Name</th>
      <th>level1Gid</th>
      <th>level1Name</th>
      <th>level2Gid</th>
      <th>level2Name</th>
      <th>level3Gid</th>
      <th>level3Name</th>
      <th>iucnRedListCategory</th>
    </tr>
    <tr>
      <th>species</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Andropogon bicornis</th>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Anthephora hermaphrodita</th>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>5</td>
      <td>4</td>
      <td>0</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>...</td>
      <td>5</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>Aristida adscensionis</th>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>3</td>
      <td>1</td>
      <td>0</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>...</td>
      <td>3</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Axonopus compressus</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Bambusa vulgaris</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Cenchrus echinatus</th>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>4</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>1</td>
      <td>...</td>
      <td>4</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>Coix lacryma-jobi</th>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Cymbopogon citratus</th>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Cyperus alopecuroides</th>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>2</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Cyperus brevifolius</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Cyperus sphacelatus</th>
      <td>8</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>8</td>
      <td>6</td>
      <td>0</td>
      <td>6</td>
      <td>6</td>
      <td>2</td>
      <td>...</td>
      <td>8</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>8</td>
    </tr>
    <tr>
      <th>Digitaria bicornis</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Digitaria insularis</th>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>5</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>3</td>
      <td>...</td>
      <td>5</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>Eleocharis flavescens</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Eriochloa punctata</th>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Fimbristylis complanata</th>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>...</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Lasiacis divaricata</th>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>4</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>...</td>
      <td>4</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Lasiacis maculata</th>
      <td>6</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>6</td>
      <td>6</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
      <td>...</td>
      <td>6</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>6</td>
    </tr>
    <tr>
      <th>Machaerina restioides</th>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Melinis repens</th>
      <td>6</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>6</td>
      <td>6</td>
      <td>0</td>
      <td>6</td>
      <td>6</td>
      <td>0</td>
      <td>...</td>
      <td>6</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>6</td>
    </tr>
    <tr>
      <th>Panicum trichoides</th>
      <td>5</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>5</td>
      <td>3</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>2</td>
      <td>...</td>
      <td>5</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>5</td>
    </tr>
    <tr>
      <th>Paspalum conjugatum</th>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>...</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Paspalum fimbriatum</th>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>3</td>
      <td>0</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>...</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Rhynchospora nervosa</th>
      <td>7</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>7</td>
      <td>7</td>
      <td>0</td>
      <td>6</td>
      <td>7</td>
      <td>1</td>
      <td>...</td>
      <td>7</td>
      <td>7</td>
      <td>7</td>
      <td>7</td>
      <td>7</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>7</td>
    </tr>
    <tr>
      <th>Rhynchospora tenerrima</th>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>...</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>Scleria secans</th>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>...</td>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>Sporobolus virginicus</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>Urochloa fusca</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>28 rows × 222 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;sex&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gbifID</th>
      <th>accessRights</th>
      <th>bibliographicCitation</th>
      <th>language</th>
      <th>license</th>
      <th>modified</th>
      <th>publisher</th>
      <th>references</th>
      <th>rightsHolder</th>
      <th>type</th>
      <th>...</th>
      <th>publishedByGbifRegion</th>
      <th>level0Gid</th>
      <th>level0Name</th>
      <th>level1Gid</th>
      <th>level1Name</th>
      <th>level2Gid</th>
      <th>level2Name</th>
      <th>level3Gid</th>
      <th>level3Name</th>
      <th>iucnRedListCategory</th>
    </tr>
    <tr>
      <th>sex</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
<p>0 rows × 222 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;taxonRank&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gbifID</th>
      <th>accessRights</th>
      <th>bibliographicCitation</th>
      <th>language</th>
      <th>license</th>
      <th>modified</th>
      <th>publisher</th>
      <th>references</th>
      <th>rightsHolder</th>
      <th>type</th>
      <th>...</th>
      <th>publishedByGbifRegion</th>
      <th>level0Gid</th>
      <th>level0Name</th>
      <th>level1Gid</th>
      <th>level1Name</th>
      <th>level2Gid</th>
      <th>level2Name</th>
      <th>level3Gid</th>
      <th>level3Name</th>
      <th>iucnRedListCategory</th>
    </tr>
    <tr>
      <th>taxonRank</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>SPECIES</th>
      <td>86</td>
      <td>0</td>
      <td>0</td>
      <td>19</td>
      <td>86</td>
      <td>63</td>
      <td>0</td>
      <td>54</td>
      <td>55</td>
      <td>22</td>
      <td>...</td>
      <td>86</td>
      <td>35</td>
      <td>35</td>
      <td>35</td>
      <td>35</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>86</td>
    </tr>
    <tr>
      <th>VARIETY</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 222 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;publishingCountry&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gbifID</th>
      <th>accessRights</th>
      <th>bibliographicCitation</th>
      <th>language</th>
      <th>license</th>
      <th>modified</th>
      <th>publisher</th>
      <th>references</th>
      <th>rightsHolder</th>
      <th>type</th>
      <th>...</th>
      <th>publishedByGbifRegion</th>
      <th>level0Gid</th>
      <th>level0Name</th>
      <th>level1Gid</th>
      <th>level1Name</th>
      <th>level2Gid</th>
      <th>level2Name</th>
      <th>level3Gid</th>
      <th>level3Name</th>
      <th>iucnRedListCategory</th>
    </tr>
    <tr>
      <th>publishingCountry</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>BE</th>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>2</td>
      <td>...</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
    </tr>
    <tr>
      <th>DE</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>GB</th>
      <td>14</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>14</td>
      <td>12</td>
      <td>0</td>
      <td>11</td>
      <td>11</td>
      <td>0</td>
      <td>...</td>
      <td>14</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>10</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>14</td>
    </tr>
    <tr>
      <th>US</th>
      <td>70</td>
      <td>0</td>
      <td>0</td>
      <td>19</td>
      <td>70</td>
      <td>50</td>
      <td>0</td>
      <td>43</td>
      <td>43</td>
      <td>20</td>
      <td>...</td>
      <td>70</td>
      <td>24</td>
      <td>24</td>
      <td>24</td>
      <td>24</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>69</td>
    </tr>
  </tbody>
</table>
<p>4 rows × 222 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;kingdomname&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>taxonId</th>
      <th>taxonname</th>
      <th>taxon</th>
      <th>kingdom</th>
      <th>article</th>
      <th>genericName</th>
      <th>specificEpithet</th>
    </tr>
    <tr>
      <th>kingdomname</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>plant</th>
      <td>28</td>
      <td>28</td>
      <td>28</td>
      <td>28</td>
      <td>28</td>
      <td>28</td>
      <td>28</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged_df</span><span class="p">[</span><span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;taxonId&#39;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;&quot;</span><span class="p">][[</span><span class="s1">&#39;taxonKey&#39;</span><span class="p">,</span> <span class="s1">&#39;taxonId&#39;</span><span class="p">,</span> <span class="s1">&#39;taxonname&#39;</span><span class="p">,</span> <span class="s1">&#39;taxon&#39;</span><span class="p">,</span> <span class="s1">&#39;genericName&#39;</span><span class="p">,</span> <span class="s1">&#39;specificEpithet&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>taxonKey</th>
      <th>taxonId</th>
      <th>taxonname</th>
      <th>taxon</th>
      <th>genericName</th>
      <th>specificEpithet</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>    <span class="n">wdtaxqid</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;5289739&#39;: &#39;http://www.wikidata.org/entity/Q4925284&#39;,
 &#39;2704745&#39;: &#39;http://www.wikidata.org/entity/Q7579252&#39;,
 &#39;2717421&#39;: &#39;http://www.wikidata.org/entity/Q15584858&#39;,
 &#39;2702504&#39;: &#39;http://www.wikidata.org/entity/Q24700355&#39;,
 &#39;2705068&#39;: &#39;http://www.wikidata.org/entity/Q10912779&#39;,
 &#39;2708680&#39;: &#39;http://www.wikidata.org/entity/Q11075670&#39;,
 &#39;2702854&#39;: &#39;http://www.wikidata.org/entity/Q15508551&#39;,
 &#39;2702852&#39;: &#39;http://www.wikidata.org/entity/Q15508581&#39;,
 &#39;2702522&#39;: &#39;http://www.wikidata.org/entity/Q15516186&#39;,
 &#39;5291147&#39;: &#39;http://www.wikidata.org/entity/Q15550242&#39;,
 &#39;2705275&#39;: &#39;http://www.wikidata.org/entity/Q33913&#39;,
 &#39;2705758&#39;: &#39;http://www.wikidata.org/entity/Q3219428&#39;,
 &#39;2705656&#39;: &#39;http://www.wikidata.org/entity/Q3367780&#39;,
 &#39;2706277&#39;: &#39;http://www.wikidata.org/entity/Q4790962&#39;,
 &#39;2702936&#39;: &#39;http://www.wikidata.org/entity/Q15504902&#39;,
 &#39;2715182&#39;: &#39;http://www.wikidata.org/entity/Q15535602&#39;,
 &#39;2706079&#39;: &#39;http://www.wikidata.org/entity/Q15504478&#39;,
 &#39;2720622&#39;: &#39;http://www.wikidata.org/entity/Q15557622&#39;,
 &#39;2712691&#39;: &#39;http://www.wikidata.org/entity/Q15564658&#39;,
 &#39;2718767&#39;: &#39;http://www.wikidata.org/entity/Q21265100&#39;,
 &#39;5289968&#39;: &#39;http://www.wikidata.org/entity/Q11066188&#39;,
 &#39;2705583&#39;: &#39;http://www.wikidata.org/entity/Q15246196&#39;,
 &#39;2705827&#39;: &#39;http://www.wikidata.org/entity/Q15509620&#39;,
 &#39;2721307&#39;: &#39;http://www.wikidata.org/entity/Q15555289&#39;,
 &#39;2706301&#39;: &#39;http://www.wikidata.org/entity/Q827098&#39;,
 &#39;2705924&#39;: &#39;http://www.wikidata.org/entity/Q4830676&#39;,
 &#39;2715045&#39;: &#39;http://www.wikidata.org/entity/Q6539452&#39;,
 &#39;5289938&#39;: &#39;http://www.wikidata.org/entity/Q14834635&#39;}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_image</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;license&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gbifID</th>
      <th>type</th>
      <th>format</th>
      <th>identifier</th>
      <th>references</th>
      <th>title</th>
      <th>description</th>
      <th>source</th>
      <th>audience</th>
      <th>created</th>
      <th>creator</th>
      <th>contributor</th>
      <th>publisher</th>
      <th>rightsHolder</th>
    </tr>
    <tr>
      <th>license</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Partial images provided by this server are released under the Creative Commons cc-by-sa 3.0 (generic) licence [https://creativecommons.org/licenses/by-sa/3.0/de/]. Please credit images to BGBM following our citation guidelines [https://ww2.bgbm.org/Herbarium/cite.cfm]. If you would like to use images in a format or resolution which is not provided here, please contact us (d.roepert[at]bgbm.org).</th>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>http://creativecommons.org/licenses/by-nc/4.0/</th>
      <td>8</td>
      <td>8</td>
      <td>8</td>
      <td>8</td>
      <td>7</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>7</td>
      <td>8</td>
      <td>0</td>
      <td>7</td>
      <td>8</td>
    </tr>
    <tr>
      <th>http://creativecommons.org/licenses/by-sa/4.0/</th>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>0</td>
      <td>4</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>http://creativecommons.org/licenses/by/4.0/</th>
      <td>21</td>
      <td>21</td>
      <td>20</td>
      <td>21</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>19</td>
      <td>0</td>
      <td>0</td>
      <td>21</td>
    </tr>
    <tr>
      <th>http://creativecommons.org/publicdomain/zero/1.0/</th>
      <td>55</td>
      <td>55</td>
      <td>55</td>
      <td>55</td>
      <td>28</td>
      <td>27</td>
      <td>27</td>
      <td>27</td>
      <td>0</td>
      <td>28</td>
      <td>55</td>
      <td>0</td>
      <td>55</td>
      <td>28</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_image</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gbifID</th>
      <th>format</th>
      <th>identifier</th>
      <th>references</th>
      <th>title</th>
      <th>description</th>
      <th>source</th>
      <th>audience</th>
      <th>created</th>
      <th>creator</th>
      <th>contributor</th>
      <th>publisher</th>
      <th>license</th>
      <th>rightsHolder</th>
    </tr>
    <tr>
      <th>type</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>InteractiveResource</th>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>2</td>
    </tr>
    <tr>
      <th>StillImage</th>
      <td>87</td>
      <td>86</td>
      <td>87</td>
      <td>37</td>
      <td>31</td>
      <td>30</td>
      <td>27</td>
      <td>0</td>
      <td>35</td>
      <td>84</td>
      <td>0</td>
      <td>62</td>
      <td>87</td>
      <td>59</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_image</span><span class="p">[</span><span class="n">df_image</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;Sound&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gbifID</th>
      <th>type</th>
      <th>format</th>
      <th>identifier</th>
      <th>references</th>
      <th>title</th>
      <th>description</th>
      <th>source</th>
      <th>audience</th>
      <th>created</th>
      <th>creator</th>
      <th>contributor</th>
      <th>publisher</th>
      <th>license</th>
      <th>rightsHolder</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_image</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;identifier&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gbifID</th>
      <th>type</th>
      <th>format</th>
      <th>references</th>
      <th>title</th>
      <th>description</th>
      <th>source</th>
      <th>audience</th>
      <th>created</th>
      <th>creator</th>
      <th>contributor</th>
      <th>publisher</th>
      <th>license</th>
      <th>rightsHolder</th>
    </tr>
    <tr>
      <th>identifier</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>http://n2t.net/ark:/65665/m30612c7f4-df88-4fbb-b508-cb574264bef3</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>http://n2t.net/ark:/65665/m3140f66a1-e14d-48e1-b859-a9cd019ffd21</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>http://n2t.net/ark:/65665/m31c9184db-f3b6-498c-b1fd-6e7356c686fb</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>http://n2t.net/ark:/65665/m31d2ae640-4b6b-4399-a7d7-50e02ec7a5ae</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>http://n2t.net/ark:/65665/m31fc6a10b-0312-48a6-b36a-e61a21a54136</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>https://inaturalist-open-data.s3.amazonaws.com/photos/355235906/original.jpg</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>https://inaturalist-open-data.s3.amazonaws.com/photos/362637316/original.jpg</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>https://inaturalist-open-data.s3.amazonaws.com/photos/63505592/original.jpeg</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>https://oxalis.br.fgov.be/images/V/BR0/000/026/554/150/BR0000026554150V.jpg</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>https://oxalis.br.fgov.be/images/V/BR0/000/027/525/951/BR0000027525951V.jpg</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>90 rows × 14 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">gbifRDF</span><span class="o">.</span><span class="n">all_nodes</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span> <span class="p">(</span><span class="n">gbifRDF</span><span class="o">.</span><span class="n">all_nodes</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<!-- Legacy scratch cell — disabled. Superseded by cells 30/31 above. -->
<!--
```python
query = """
    PREFIX wd: <http://www.wikidata.org/entity/>
    PREFIX wdt: <http://www.wikidata.org/prop/direct/>
    SELECT DISTINCT ?taxon ?taxonLabel WHERE {
           ?observation wdt:P225 ?taxon .
           ?taxon ?p ?taxonLabel .
            }"""
results = gbifRDF.query(query)
for row in results:
    print(row["taxon"], row["taxonLabel"])
    mdFile = mdutils.MdUtils(file_name='taxa/'+ row["taxonLabel"].replace(" ", "_"), title=row["taxonLabel"]+" ("+row["taxon"]+")")
    if URIRef(row["taxon"]) in taxoninformation.keys():
        if "wikiintroduction" in taxoninformation[URIRef(row["taxon"])].keys():
            mdFile.new_line(taxoninformation[URIRef(row["taxon"])]["wikiintroduction"])
            mdFile.new_line(f"Read more on [English Wikipedia](https://en.wikipedia.org/page/{row['taxonLabel'].replace('' , '_')})")
        mdFile.new_line(f"Visualize Wikidata on [Scholia](https://scholia.toolforge.org/taxon/{row['taxon'].replace('http://www.wikidata.org/entity/', '')})")```
-->
<!-- Legacy scratch cell — disabled. References undefined variables `table` and `verified`. -->
<!--
```python
import mdutils
for taxon in table.keys():
    if table[taxon]["taxon_name"] in verified:
        mdFile = mdutils.MdUtils(file_name='new_articles/'+table[taxon]["taxon_name"].replace(" ", "_"),title=table[taxon]["taxon_name"])
        mdFile.new_line(f"[iNaturalist taxon id: {taxon}](https://www.inaturalist.org/taxa/{taxon})")
        for image in table[taxon]["photos"]:
            mdFile.new_line(f"![{table[taxon]['taxon_name']}]({image.replace('square', 'medium')})")
        mdFile.create_md_file()```
-->
<!-- empty cell --></section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Load occurence data</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#fetch-institute-qid-s-for-institutes">Fetch institute QID’s for institutes</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#resolve-taxonnames-and-kingdom">resolve taxonnames and kingdom</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#merge-taxonnames-and-kingdom">Merge taxonnames and kingdom</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#below-is-for-reference-only">Below is for reference only</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Sofie Meeus, Quentin Groom, Andra Waagmeester
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <p>Data sourced from <a href="https://www.gbif.org/">GBIF</a> and <a href="https://www.wikidata.org/">Wikidata</a> under open licenses. Maps © <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors.</p>
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>